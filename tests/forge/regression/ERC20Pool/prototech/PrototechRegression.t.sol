// SPDX-License-Identifier: UNLICENSED

pragma solidity 0.8.18;

import { BasicERC20PoolInvariants }       from "../../../invariants/ERC20Pool/BasicERC20PoolInvariants.t.sol";
import { LiquidationERC20PoolInvariants } from "../../../invariants/ERC20Pool/LiquidationERC20PoolInvariants.t.sol";
import { ReserveERC20PoolInvariants }     from "../../../invariants/ERC20Pool/ReserveERC20PoolInvariants.t.sol";

// we should probably make a PrototechREgression.t.sol under ERC721Pool, but this is the only one for now
import { LiquidationERC721PoolInvariants } from "../../../invariants/ERC721Pool/LiquidationERC721PoolInvariants.t.sol";
import { ReserveERC721PoolInvariants } from "../../../invariants/ERC721Pool/ReserveERC721PoolInvariants.t.sol";

/***********************************/
/*** Basic ERC20 Pool Regression ***/
/***********************************/

contract PrototechRegressionTestBasicWith10BucketsIndex6500Pool is BasicERC20PoolInvariants {

    function setUp() public override {
        // failures reproduced with 10 active buckets
        vm.setEnv("NO_OF_BUCKETS", "10");
        vm.setEnv("BUCKET_INDEX_ERC20", "6500");
        super.setUp();
    }

    function test_regression_prototech_R7() external {
        _basicERC20PoolHandler.addCollateral(
            2,                               // actor index
            787978178697424804260644669040,  // amount to add, 787978178697.42480426064466904 * 10^18
            6502,                            // bucket index
            13838                            // skipped time
        );
        _basicERC20PoolHandler.transferLps(
            7,           // from actor index
            5,           // to actor index
            1672524930,  // lps to transfer
            6502,        // bucket index
            83798        // skipped time
        );
        _basicERC20PoolHandler.removeCollateral(
            5,      // actor index
            37232,  // amount to remove
            6502,   // bucket index
            46650   // skipped time
        );

        invariant_bucket();
    }
}

contract PrototechRegressionTestBasicWith10BucketsERC20Pool is BasicERC20PoolInvariants {

    function setUp() public override {
        // failures reproduced with 10 active buckets
        vm.setEnv("NO_OF_BUCKETS", "10");
        super.setUp();
    }

    function test_regression_prototech_R1() external {
        _basicERC20PoolHandler.drawDebt(289417789361174372031056620741, 1000326246414552022, 1672427362);
        _basicERC20PoolHandler.addCollateral(3, 1363197669977567662485698544889893768624935214644, 176983931167823887652565227718535462076497, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _basicERC20PoolHandler.addCollateral(911338679565033631452753933741615870561500127200336515196, 100678485169218822286975041, 562157048161658889287796612, 396901311837079147383971976);
        _basicERC20PoolHandler.removeCollateral(3, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 43710635734924245562, 1);

        _invariant_R1_R2_R3_R4_R5_R6_R7_R8();
    }

    function test_regression_prototech_R2() external {
        _basicERC20PoolHandler.addQuoteToken(3, 1220382137948272011446728337739826893, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _basicERC20PoolHandler.addCollateral(1038320573183676909240324237485386031762797434733405183946263329789040728, 1130330236254, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 3033887066257962770966405067568203133014825658008469487494673162404);
        _basicERC20PoolHandler.drawDebt(0, 31916080285492740679802985241918096165647794897794462450, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _basicERC20PoolHandler.removeQuoteToken(3, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 1245491196095668653353385336965919096300160969748209210);

        _invariant_R1_R2_R3_R4_R5_R6_R7_R8();
    }
}

contract PrototechRegressionTestBasicWith50BucketsERC20Pool is BasicERC20PoolInvariants {

    function setUp() public override {
        // failures reproduced with 50 active buckets
        vm.setEnv("NO_OF_BUCKETS", "50");
        super.setUp();
    }

    function test_regression_prototech_R13() external {
        _basicERC20PoolHandler.failed();
        _basicERC20PoolHandler.moveQuoteToken(34182676062, 970158087771364439539778133424113234, 1, 50017338003875636400341733247242921922496740278556121448487335793831930540, 3067532913292792342692150086977398352312578700620413579318);
        _basicERC20PoolHandler.drawDebt(5820082102171667022399950811436, 3242640055857068520668315784493, 670710516457);
        _basicERC20PoolHandler.moveQuoteToken(18145807299774538093937063302654, 1000052996020447694427851, 999989257700734373607181, 4396684808555526263271298132905, 2040535202705094120750690683233);
        _basicERC20PoolHandler.pullCollateral(999994871987446319721815, 1771329963446586802365734, 3269844105608643793722252149332);
        _basicERC20PoolHandler.failed();
        _basicERC20PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 0, 31699623829);
        _basicERC20PoolHandler.pledgeCollateral(100521140450422249462631192163, 688711965012732107216775029442215211430100176853223388571240788410003740, 1000000038832137544);
        _basicERC20PoolHandler.pledgeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 28259776562747879);
        _basicERC20PoolHandler.moveQuoteToken(13227714780918418725924618016471, 1000146889692929679, 181096, 12598590786881105095850906999362, 19547576362155410255197798970);
        _basicERC20PoolHandler.drawDebt(2445750000640898853895126377044012123625962211732271243639090268644970, 1226525778761671239062908923649185239656, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _basicERC20PoolHandler.removeQuoteToken(352216804030123402021476683379469812418976779508, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 220361129521238981038610009680920044527620204581081624098826, 4342705436174701075);
        _basicERC20PoolHandler.transferLps(15469132485381641406, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 2, 3, 10478733579022428786263005561292836351);
        _basicERC20PoolHandler.pledgeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639932, 1450472351063547097553538654575, 4360285342926014934612718913145244103756206329784014643152);
        _basicERC20PoolHandler.addCollateral(3, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 1174);
        _basicERC20PoolHandler.addQuoteToken(30220971133366294501, 243003300871099990949027014890592935041180747299780466704988276, 113235329182260719232995, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _basicERC20PoolHandler.transferLps(16642157611467936440569657737277, 1000000564971977347, 779955687682199966516445294, 1841174764418171586902213447971, 17109525202894744223411871130636);
        _basicERC20PoolHandler.addQuoteToken(4628384247688151425960544334498, 1758, 1000001001818547780833711878284, 1000865946948674394);
        _basicERC20PoolHandler.pullCollateral(1000001549840829808, 6979389713326688733594586551375, 4159551138396654646110244116807);
        _basicERC20PoolHandler.addCollateral(2848598129910512528776540017, 2602419939490867698246836676, 109073038504450877860386096, 1000000479725015747);
        _basicERC20PoolHandler.pledgeCollateral(0, 1476900985911136504704276797056466511450983313463939089209026327, 67595003238650535);
        _basicERC20PoolHandler.failed();
        _basicERC20PoolHandler.moveQuoteToken(9670419769248949774800707926208, 60823513514244421877066315413, 6955353851318930798747740600082, 2297996183579663219653985824192, 5944723110224316486837885781149);
        _basicERC20PoolHandler.removeQuoteToken(3, 28456151173306127960, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 5111020854338401000450129316971226786719635576935235061677566665);
        _basicERC20PoolHandler.drawDebt(164864961660056213136949045650818218259364943982438645, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 2808415713057137184);
        _basicERC20PoolHandler.drawDebt(371182083582924222, 1213375982307012570761066659911, 12305028137790809861836936374898);
        _basicERC20PoolHandler.addQuoteToken(5383995493679536971408170876304, 7951413802159919618251860204, 816672615588694807138518414763, 1000000651245620735);
        _basicERC20PoolHandler.drawDebt(2170933527641554808432382958442, 1000000215429981916, 131549605740758997979114);
        _basicERC20PoolHandler.transferLps(3, 918634844508, 3, 39891819650340625376565560528019860193625293493949445392378264398084, 2253607610782397438736724710089998662244917416809926042768);
        _basicERC20PoolHandler.removeQuoteToken(21322176756892, 1000000213488331991, 1566233042159894090237861894903, 16400660656922335382876703038);
        _basicERC20PoolHandler.removeCollateral(96190203153722691908494290138138525821290763886274385, 3, 924960416667555308752565715119267014114460, 82572182916673747619796921052573954549989552210038073082085);
        _basicERC20PoolHandler.moveQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639933, 1, 1951109388690811936097463166849145488, 421481079897247115942816911681545106515673173, 1837649641068518025495752648868694759231878699127623631469758858);
        _basicERC20PoolHandler.repayDebt(370993871622948567674, 8803249075720986523963443459001, 892262914386273471823938221);
        _basicERC20PoolHandler.repayDebt(1000000313939407996, 810371183977029455607295701312, 8956201731365026391592268154203);
        _basicERC20PoolHandler.moveQuoteToken(3, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 149178867143);
        _basicERC20PoolHandler.pullCollateral(46922780519814871870648929833, 1394294415673464291858604382753, 1001981804814325054);
        _basicERC20PoolHandler.pullCollateral(3, 742665369587500954226, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _basicERC20PoolHandler.pledgeCollateral(14115264187845706996338756671094, 4243081351457659367880406525817, 1375352289744147236012812151379);
        _basicERC20PoolHandler.failed();
        _basicERC20PoolHandler.removeQuoteToken(6016843246592103049412676106117, 1000000009006415793, 20967964041879472799, 999987932743761792167896685610);
        _basicERC20PoolHandler.transferLps(2, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 1154606772447034032354398494953, 0);
        _basicERC20PoolHandler.failed();
        _basicERC20PoolHandler.pledgeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 161243354823191951247460113103779636030986165035459547);
        _basicERC20PoolHandler.addCollateral(1000003691272481734376617742701, 8608919335388172166347599924299, 4927136669678064201439860291727, 780795723222220925849345098);
        _basicERC20PoolHandler.failed();
        _basicERC20PoolHandler.drawDebt(3503800829570632267366382856602, 1000002534521444810, 3814431522930428690554509537);
        _basicERC20PoolHandler.repayDebt(0, 3, 4904518825344111961288104089044319);
        _basicERC20PoolHandler.removeQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639933, 15717841331141925937847780875499980360430316510053, 2, 121038187619052413);
        _basicERC20PoolHandler.moveQuoteToken(1000000008076584618, 5848473612237151881205558739064, 16737200700400270965457876048, 12909756433240243654774318756355, 689636489280006190849750735644981284975298969525225815988428057446939637);
        _basicERC20PoolHandler.pullCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639935, 1776239217836263630273227850499853262728452447501079199654229550312166, 18958693491382425313784050802);
        _basicERC20PoolHandler.removeQuoteToken(6321400534613396948884872067838, 1518841243531096, 999997412112133608812341745998, 10593051961274112956526086648677);
        _basicERC20PoolHandler.transferLps(1864492503439917513276430185205322227504844595833265979727172078052219, 2289427242241238318584841332309776577784727569708975882267244, 14807865, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 2730707600860794794182625456252919176240757);
        _basicERC20PoolHandler.transferLps(22665728832597595555842398342358091060, 3586064999759931378417, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 2, 2746657);
        _basicERC20PoolHandler.repayDebt(3, 0, 1);
        _basicERC20PoolHandler.addQuoteToken(3952677405859396231243898748794, 1000000000000009077, 12390108199112777329521961839757, 1133435712117577842092762150604);
        _basicERC20PoolHandler.removeQuoteToken(12189652672028427613127767117, 8335094658810698638489294500404, 1012998195122322954429741707667, 5249371392796101794093236537531);
        _basicERC20PoolHandler.pledgeCollateral(12498829903090800316241132513242, 4185636787667213755609790093964, 4737680543264837093962806837543);
        _basicERC20PoolHandler.pledgeCollateral(40435468535850044013638377183811390714835838251366683963791296541459631182848, 2948832383984762819926392130776195389832433020044048887, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _basicERC20PoolHandler.addCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639934, 212785604240372785056038204462164218237303810082422344934946404516707584, 38852096081423364867136, 57055017697057773477432240343786106803836878017413586718672007437185669130497);
        _basicERC20PoolHandler.addQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639933, 167, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 57111957065967803818328222647995239792299726723495816518651167923118496);
        _basicERC20PoolHandler.pullCollateral(768050145529224110062949895269, 4755641899219745401173943879575370735, 787874331566309775038256692273);
        _basicERC20PoolHandler.transferLps(4303624829255551207045973198, 7110582288270656432486703809487, 8232718412259171875949879648181, 14282796296304386992646004987, 26131769629372394412954298591469624218);
        _basicERC20PoolHandler.addQuoteToken(1278839501218636457, 5656224067017713672205841751393131163945177132650831508064773814423077619, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 0);
        _basicERC20PoolHandler.removeCollateral(2, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 1461847506878979628291816951183841970946275, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _basicERC20PoolHandler.addQuoteToken(14258127157546991695282170542158, 837138141666261854451366298631, 25653, 364428639066466789269042042986);
        _basicERC20PoolHandler.removeCollateral(1921692115640573313101402738641, 689886279340064385908758923199347264617981106303732792840948669549183427, 2031088078793900122413848513112153220, 7138170918334767277916486396643);
        _basicERC20PoolHandler.pledgeCollateral(1511353038936459134502580364878, 2043244881870722399788508519770, 26653102029042634786875641102);
        _basicERC20PoolHandler.pullCollateral(62276, 1000000068833961250, 1000000286846249238);
        _basicERC20PoolHandler.addCollateral(13580791985062569414787422942, 999999999999999999981250576485242675207594068, 830381646401724020117576571967, 4715948711718905117365009);
        _basicERC20PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 2674847475107919674613160046754229363688358737171513424588627867114, 867109411835157619, 1291588174268998263142035221308);
        _basicERC20PoolHandler.removeQuoteToken(688856767768271816027278624575311075717188152626663277965609186781089580, 10069909736302378753441306081789, 866965658436353434972092230696, 1817875723060286662483706081716);
        _basicERC20PoolHandler.pullCollateral(157602042593879091886344073, 2030619065581629836457288503232, 1000003568990023384);
        _basicERC20PoolHandler.removeCollateral(3767612674406241380377242769722, 976095192206253656600786703, 1003944374632095261975019259907, 3665460639048944854902466666809546285);
        _basicERC20PoolHandler.moveQuoteToken(3, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 0, 78655967765677870982872666273855466508430720542091345, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _basicERC20PoolHandler.failed();
        _basicERC20PoolHandler.addCollateral(24823885281544015638993198742571509593400853639305703712982316110243, 23433291684564865928324855, 186990142917149, 196464933555953772514942038852666087283878235427470);
        _basicERC20PoolHandler.addQuoteToken(914615192243660269178196561226, 3264916079688089910712842280737, 15099541215479868329375770832495, 16106966662265309271896997391412);
        _basicERC20PoolHandler.drawDebt(8654068440603694010473536924776, 542849309957011288320562573377, 13815448423648449677576886336926);
        _basicERC20PoolHandler.moveQuoteToken(1000001047420103858706177912990, 688711520726501630491143647600535920945463831514539666507710456194059178, 7943866912446475257, 787978275380069954857407747099, 19542985318092056031923417687380406410);
        _basicERC20PoolHandler.repayDebt(2, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 3);
        _basicERC20PoolHandler.pullCollateral(142506589264250689125620329918129386078292305990372876791272, 792018812521466583012060658532097173421905728409338239087115, 778958633583197084611360132555488597141816616783347060197193756112763);
        _basicERC20PoolHandler.moveQuoteToken(1, 32756108603327786636688571964074895176, 2, 2, 3);
        _basicERC20PoolHandler.transferLps(0, 11115726873345345610543832099664320098982701867258553090356878022288048684, 382381577216, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 1052666780622375078788026794671691863376129);
        _basicERC20PoolHandler.removeCollateral(2029055755780415275396907741399, 4019803831193014523556208246224, 1513852721012395704665449510550, 8258463717540407168463041113581);
        _basicERC20PoolHandler.drawDebt(1362710248000, 3, 118);
        _basicERC20PoolHandler.transferLps(5694979460976308736849238011715, 167987481489083223837961783846, 2049652644973835441541466385140, 1000001446772934858, 166475089333512454377295226218);
        _basicERC20PoolHandler.removeCollateral(689803447108905672378405905283151101429586032854360596881580649156448645, 9979851052523547534061513730271, 6313020450165589039984210098583, 627213088713399867246918082);
        _basicERC20PoolHandler.addQuoteToken(1999991459229058123295302, 3514606977856790899185240338673, 5817606439554584156630424188939, 2985052539206461887948651048760);
        _basicERC20PoolHandler.moveQuoteToken(318508679946408, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 24435201506425761445689317859169);
        _basicERC20PoolHandler.pledgeCollateral(1664724, 113655680583891580800407288357237136768, 47877492598459766182049934352663221628937507353710925495422);
        _basicERC20PoolHandler.drawDebt(10363521532033957916836719200970, 4134301431609115339827687813469882693, 401950858153446921587198974);
        _basicERC20PoolHandler.drawDebt(41193067028073771300319060281311291690073227384391, 311405431062242676888570909675743064068291219858226726775, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _basicERC20PoolHandler.repayDebt(439329704426936210385611193, 3495404292170272792573718008310, 787900489350008246419924933447);
        _basicERC20PoolHandler.transferLps(3, 231308143841887834474860344, 0, 1, 32317);
        _basicERC20PoolHandler.addQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 0, 39317366240620493086814317208);
        _basicERC20PoolHandler.drawDebt(15033620233709468536040400036471, 4371806179501691912902094292012, 1829458267153534443419428770942);
        _basicERC20PoolHandler.drawDebt(2802397417581221556077471418929, 1000000130303688234, 1770814287895931020186227484105);
        _basicERC20PoolHandler.removeQuoteToken(1, 843499327028574795657740238801801820843115887452931987426816152455910605634, 3, 3306921663970944303501116638790069224076371271312111422712306896102623);
        _basicERC20PoolHandler.addCollateral(999997425020157000840529, 787976025626386380219429245062, 787934480261659729454180168871, 7996922132153285840642367949337);
        _basicERC20PoolHandler.repayDebt(115792089237316195423570985008687907853269984665640564039457584007913129639933, 4553767367766, 75612072153481239189746174128787401338352179750923);
        _basicERC20PoolHandler.addQuoteToken(4944799575657565807539570, 2, 1880692182446467268621612580813509324116968258735857911702814878, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _basicERC20PoolHandler.transferLps(11793206468696045209650051357308, 15771382973377845625507732906438, 12280085661987828376847131723964, 86966966660282772566197527208069279, 13860703128300828489000048381049);
        _basicERC20PoolHandler.removeCollateral(4553222405570054494656155910392, 928585425127793252005108621, 999997375923835377804922, 1000000505095340149);
        _basicERC20PoolHandler.moveQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639933, 3, 45442370797512183704053209, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 1);
        _basicERC20PoolHandler.repayDebt(3, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _basicERC20PoolHandler.pledgeCollateral(1000000001692916428, 1636667790499253211485483959980, 6211176347631734764269560778483);
        _basicERC20PoolHandler.moveQuoteToken(27571292828755508, 2204117331749706325081561466372, 12204383037718011175247418867396, 11054130208935028107610300106157, 8155809803846312112751701590099);
        _basicERC20PoolHandler.repayDebt(79045204198949795420201380180540395372768527609204317615800469543755965, 8528493885709873602052381, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _basicERC20PoolHandler.pledgeCollateral(2, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 2);
        _basicERC20PoolHandler.addCollateral(668375853357549364344056913017418361056, 1046871752362931010392086957451, 594330259435544309632822650588, 1000001243935780341888730865639);
        _basicERC20PoolHandler.removeQuoteToken(4693665025378, 440810499353370202, 1, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _basicERC20PoolHandler.transferLps(2, 1, 847205150922176, 436708, 511579442783773064516955879630);
        _basicERC20PoolHandler.addCollateral(13560267846422118775249872430545, 1999882654503269369069508, 1000010146973850428, 1000008482465432493640764877929);
        _basicERC20PoolHandler.repayDebt(336197300923494585554796632167, 10155900671545374603174699141017513816, 36084762525716605830429161072512730292986926669475210696482198144838317073999);
        _basicERC20PoolHandler.addCollateral(1000000161041243310, 2575960022281475175982579524828, 223263738353014583975759724, 8700);
        _basicERC20PoolHandler.repayDebt(2774031588075072969324472221787054155743, 11832110369641083745008510601647, 3208141661742968816520687471971);
        _basicERC20PoolHandler.repayDebt(4238125953327187143851272602362177766036095116704636491139273473, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _basicERC20PoolHandler.transferLps(4271962157284283007454279163904093786245775611, 202792388122062917340740, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 19775904609742339560618359582341954247630, 3);
        _basicERC20PoolHandler.pullCollateral(9624327937688671426063332896781, 11309367046694359349137945137404, 9659332590899017806788972960905);
        _basicERC20PoolHandler.pledgeCollateral(15, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _basicERC20PoolHandler.removeQuoteToken(3439263013327512135655010954711, 1290450362564154915504532084768, 212087356835500867124390920, 1000449269301454476);
        _basicERC20PoolHandler.addCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 40279612661425308613413822546811247623384534225372328480542312815858079891, 0);
        _basicERC20PoolHandler.removeQuoteToken(16218674510859937728693485425261, 787978903125484366274407648561, 688609312267804320429342744383472849315534960104665668737408918887369129, 1000000068704764762);
        _basicERC20PoolHandler.pullCollateral(13010477148891715695361425035987857837961057377674873363, 2, 101774073669224520235539709250931963723360531284754782900522021389);
        _basicERC20PoolHandler.transferLps(2, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 6693884092424998197247908018222155215907184615, 16056913, 3);
        _basicERC20PoolHandler.failed();
        _basicERC20PoolHandler.repayDebt(496396272, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 2);
        _basicERC20PoolHandler.pullCollateral(659144238942009179054853811485973835077558547879514, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 1);
        _basicERC20PoolHandler.failed();
        _basicERC20PoolHandler.removeQuoteToken(6281313659141, 11884600926566596018596478401728, 1219087170786459469437673368220, 2025986271801134642134767147638);
        _basicERC20PoolHandler.removeQuoteToken(0, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 326112127925564999331094045378376475949212737440980971941446411943479, 6434500791985149496307106);
        _basicERC20PoolHandler.pledgeCollateral(0, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _basicERC20PoolHandler.addQuoteToken(3050848821909768682548083885285, 657285911950424895960167051152, 1000000345383959543, 3551890758024576379487654379038);
        _basicERC20PoolHandler.failed();
        _basicERC20PoolHandler.transferLps(790000389142176500354676968467, 390957163211204477939790150, 999997226614847188977575294777, 819833956051706757616758943, 4702808693545516525059706965683);
        _basicERC20PoolHandler.removeCollateral(0, 81507328931651368522732704547, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _basicERC20PoolHandler.repayDebt(115792089237316195423570985008687907853269984665640564039457584007913129639932, 44641732331038083710146152, 3);
        _basicERC20PoolHandler.moveQuoteToken(1, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 36995998982918705004305838922559087019775570527569699337708391043056694164110, 0, 32648679133944744925452901857755038220487237950);
        _basicERC20PoolHandler.pledgeCollateral(517810995908884773027406481753381341891787678755315856013335539380597328, 3, 1);
        _basicERC20PoolHandler.moveQuoteToken(1000001256591839641, 3858261878126232107618622969749, 6699896036225213357561556468740, 5428305498675686790270631743555200284, 1000008666990508201);
        _basicERC20PoolHandler.removeQuoteToken(16531139506126214667308130500593945395567974, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _basicERC20PoolHandler.drawDebt(45610128979952496045855015702, 2101995276247489019573071744224814217240474714592266458, 0);
        _basicERC20PoolHandler.pledgeCollateral(16046200698497380185688514323448, 787947709349614574234544822738, 1999955393517448374456517);
        _basicERC20PoolHandler.pullCollateral(2301056252919105944332393152113, 1676370555, 688952062228195401711591903150611336999632712826113848843443138966099153);
        _basicERC20PoolHandler.moveQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639935, 7, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 5692944822977849548454191257061399739102011277539921908328258669878, 161281995902);
        _basicERC20PoolHandler.pledgeCollateral(8040895546020147179462673209969, 930614716073010374174302672489, 5794941217569108778312997123478);
        _basicERC20PoolHandler.removeQuoteToken(2, 77377643242386754458231666851486392635592, 1, 8897597992366348148003297039128815811278334269180);
        _basicERC20PoolHandler.removeCollateral(1000176460561907671, 824341507961999036588320651433, 14124187503256689898855077718204685, 1759767984295968367711509234947);
        _basicERC20PoolHandler.transferLps(115792089237316195423570985008687907853269984665640564039457584007913129639935, 2, 936, 276468659489867952101577774339005907, 194994617060293408);
        _basicERC20PoolHandler.addQuoteToken(14918286105829437940827061931884, 1000000005572987789, 809414650642727705886104932220, 1000000176025067676);
        _basicERC20PoolHandler.drawDebt(2515277558514612949179880208389, 10830688000723917443509040203965, 4080691289040392958393941806641);
        _basicERC20PoolHandler.moveQuoteToken(13959223451345792911680537756287, 1114120938876567787055889625443, 1000000024526944150, 3757235766550055725705624, 9554347516069769924900997398605);
        _basicERC20PoolHandler.drawDebt(115792089237316195423570985008687907853269984665640564039457584007913129639934, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _basicERC20PoolHandler.removeQuoteToken(3, 342730, 907485979751436669189383329785018303435983, 3);
    }

    function test_regression_prototech_R18() external {
        vm.setEnv("QUOTE_PRECISION", "6");
        vm.setEnv("COLLATERAL_PRECISION", "6");

        setUp();

        _basicERC20PoolHandler.drawDebt(8610950656866698149703667322, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 2957072626826143835923340786513923311);
        _basicERC20PoolHandler.pullCollateral(12221672537733006607770, 55196022227499777, 329580468254324473134);
        _basicERC20PoolHandler.addCollateral(11738798130952868, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 1076083879369, 4356154);
        _basicERC20PoolHandler.transferLps(115792089237316195423570985008687907853269984665640564039457584007913129639934, 1, 9045265070224768078933056779354580670983060687111863442959, 442755543045705050213456416813716348808036095386767949505304, 1071304108983398616053476277402079455339204883793822017);
        _basicERC20PoolHandler.repayDebt(13412794478054627999906810689932, 823633941646465634075408025682, 714246153571865300760303572146);
        _basicERC20PoolHandler.addQuoteToken(7486986084195651716458434897639, 1000000664010591218, 999914887205083282385961, 999985349735554704748005);
        _basicERC20PoolHandler.transferLps(487648, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 3868565841888539883563965410106, 2374507191547192227724457270596843019313139981943688698822712);
        _basicERC20PoolHandler.transferLps(689398924496056613691032738434157115168193601982832565776589432118434001, 9145175593727453394097749794255, 14787629956578272478, 20733937950822055339911461111987, 2000004548842457416230943);
        _basicERC20PoolHandler.addQuoteToken(1, 1, 19970066149439701117472862136, 5736394984046250309200325076914005570040);
        _basicERC20PoolHandler.repayDebt(115792089237316195423570985008687907853269984665640564039457584007913129639933, 24935051074824334928071690968307380, 325483530522);
        _basicERC20PoolHandler.addCollateral(769734662906903542025005387356111556688784492093856706807262335, 285182884945322520945210733747532522143075882604792030406497, 11476809992691040954671027345377461996648243631519456563, 1100195040152269636516334608609215598296068687791874552932280382029749);
        _basicERC20PoolHandler.moveQuoteToken(5695564060379210077844338, 345695996057729595665245433223659963133359129113904107539355, 2, 0, 264902151750310089643307);
        _basicERC20PoolHandler.addQuoteToken(584290825868243852358036, 205602919042137110288106678, 35447041625849908005193683530596, 1000000000040745749);
        _basicERC20PoolHandler.transferLps(115792089237316195423570985008687907853269984665640564039457584007913129639933, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 228550014);
        _basicERC20PoolHandler.moveQuoteToken(632745769610149887932357980527, 3753578404012007965145014740, 2909170827804392931243507251897, 21857135740246108574701114069379, 1000000000005342227);
        _basicERC20PoolHandler.addQuoteToken(3, 3, 0, 3);
        _basicERC20PoolHandler.transferLps(89127314388534690433761377515895533917773773732325115881593636557663315814474, 1, 34341289433952255917813315526469051462562409760, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _basicERC20PoolHandler.pledgeCollateral(9376769682553370399581822893243, 777261192856506080090875212654, 11266164282434237130682702614353);
        _basicERC20PoolHandler.addCollateral(3, 0, 26616765982773322256439597140652, 215339150857146737);
        _basicERC20PoolHandler.removeCollateral(1000003952445366322, 2009130552584451600000000000000, 4264063035757426951000000000000, 9630012716190359756807170320761);
        _basicERC20PoolHandler.pledgeCollateral(0, 15609258654503368, 2073541312975615497698);
        _basicERC20PoolHandler.moveQuoteToken(16455725644507200635075951786, 12745610022219460676935783182256, 331417736077068136476907449015927662756410290874565252660769459, 8615368476648199680000000000000, 5907889703849609229965754883086);
        _basicERC20PoolHandler.addCollateral(1494155660179479635021255697058, 4876300464539913368300168937377, 1000001376523017421, 2000000117034496909604523);
        _basicERC20PoolHandler.pullCollateral(3761287161370000000000000, 866535061383111992000000000000, 14259601191223676791963893966128);
        _basicERC20PoolHandler.moveQuoteToken(2000015874494446566431630, 347881045069010781270695144905, 8490607480371992463, 774771695091328741059450156647, 7101274555459050508402816);
        _basicERC20PoolHandler.addCollateral(1, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 3);
        _basicERC20PoolHandler.repayDebt(0, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _basicERC20PoolHandler.addCollateral(0, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 0, 35184409811768);
        _basicERC20PoolHandler.removeQuoteToken(710965066212411763415542778140, 1134410221369583, 1000000182878688276, 23603606016898269855379283663418);
        _basicERC20PoolHandler.addQuoteToken(378392735311298488736926645577047, 2, 624001358380741582157712635859553145965105843255, 549153487321800511338877383597987623815306029025);
        _basicERC20PoolHandler.pledgeCollateral(759777067783342925963720213699, 105858314493208551929743587, 2069001278169244466419);
        _basicERC20PoolHandler.repayDebt(6663, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _basicERC20PoolHandler.addCollateral(412312006929191, 2232700348781204894652609231950, 929967212873753935348640950692, 2930106927206943005518098596512);
        _basicERC20PoolHandler.removeCollateral(3170228021293353111528417808377, 4359858948799370183937144152116, 1042949223261126759990106840865, 2508659655056078568187550126344);
        _basicERC20PoolHandler.addCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 14260106444473657978717944622556904140595776596, 17811095678730745411673157595760376, 2);
        _basicERC20PoolHandler.addCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639932, 130701502066868037935841408563398868399565889922428, 1, 47139846906334973640625557568749815753942535994419);
        _basicERC20PoolHandler.transferLps(115792089237316195423570985008687907853269984665640564039457584007913129639933, 108237482200245656555431115741541924211787191778279992620923909669358, 836727670924962740296317914298160620869376611497954724, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 239645398748203918394378963183725601225680588427380377);
        _basicERC20PoolHandler.moveQuoteToken(6836689636704157927615581974553, 662444129140363218769516800761, 9934438604392253724266745186361, 12337601713236770234092099436769, 13802010996130259168549321573778);
        _basicERC20PoolHandler.pullCollateral(488806873552836977119875720658576413267447187, 1, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _basicERC20PoolHandler.pledgeCollateral(2, 4427457646367660527726711929407213622225, 0);
        _basicERC20PoolHandler.pledgeCollateral(91571647272549443994839235883943541130185605861950643216853, 0, 9764372746114538896908141035026025570008644754688394770981400001628);
        _basicERC20PoolHandler.moveQuoteToken(8650729477265957135526746, 10465352225960142538155118210642, 309762490667623715700389746771, 10626216672954330611762488735894, 2179353863188761820762300389820);
        _basicERC20PoolHandler.addQuoteToken(1000000525247835785708896, 8048389194820429704232257172673, 999622979586719714397, 799149065053565683419177);
        _basicERC20PoolHandler.moveQuoteToken(2, 31603355378740650724968506296841678012951645216607945286, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 244506867455973073970853910500074117583819, 49376142919106304462042114);
        _basicERC20PoolHandler.repayDebt(5574355003382296028143020515978, 7044573207597829770190274292235, 2956686194891288);
        _basicERC20PoolHandler.moveQuoteToken(2833576484131924009885513156905944623189, 13806887408248354127932221349155598372430, 901519481314065, 7, 76606);
        _basicERC20PoolHandler.addQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639933, 5753025402025816828735460102460470817153737668705871620970966, 767454369187102894829236024300788364532897203638488263889910, 3578877792994885231119001989635157027204546495729256344);
        _basicERC20PoolHandler.pullCollateral(1000000059103663918, 14519918341147206813148532091059, 384091302923626057719282923);
        _basicERC20PoolHandler.drawDebt(17850248286715690192008180615423, 1704101778991800029778978452501, 1000018501570415662);
        _basicERC20PoolHandler.transferLps(1206658042181513171262049436167233118598028968465465521, 284476046937780528651371129, 1715560165987886328285441562733323478423003432933042, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _basicERC20PoolHandler.removeQuoteToken(14172105761662118261681284413839729644202784646868976722154038514, 3, 2804251439030950389256959390835637945198, 14875389964642);
        _basicERC20PoolHandler.addCollateral(39543756085918795476056663554519944676038620820628397002281798, 4217614779006745092567056923508953372398254101384554720907408061, 3003209123163739059044386468076054645728521231259864437244750, 273507747462378673905);
        _basicERC20PoolHandler.pledgeCollateral(7740017442266093962688716082595, 2234430355345000000000000, 7140474430549016734000000000000);
        _basicERC20PoolHandler.moveQuoteToken(1, 52177248948567192184494220122634162382317029219280351118, 3, 1, 1);
        _basicERC20PoolHandler.repayDebt(1, 14035293867, 747891235436551);
        _basicERC20PoolHandler.addQuoteToken(36645717695490850481029502763970540095237599713408936504056597, 3, 1, 7994805400408563987902421454);
        _basicERC20PoolHandler.addQuoteToken(1, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 610086277501157880684796787387724900311737671358462595791, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _basicERC20PoolHandler.moveQuoteToken(1, 2235962185351637708632975123940277608970005320941693648847125493216390, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _basicERC20PoolHandler.removeQuoteToken(16688702675254346275462706262912076270881025881882465450, 414345276736171, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 365714925548120884844907954501748744987890114060015816951766380147495);
        _basicERC20PoolHandler.pullCollateral(617159095793287210038279142364, 2150848617803, 261241087997724837914455911013956130188638745874314233791);
        _basicERC20PoolHandler.pullCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 122257892088991717138947643548296334771932226858376868301251676105, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _basicERC20PoolHandler.moveQuoteToken(1, 5102571212561874496875732, 400044393115889421709632, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 222149028339436374480);
        _basicERC20PoolHandler.removeCollateral(786570662425115383171823382962, 715376604759265683761007447819, 1000000325796230281, 33588737318749466815043588854742);
        _basicERC20PoolHandler.addCollateral(505722, 12242574676285136021265601248818510753020289019257520995929385689505765, 2, 525880689973883);
        _basicERC20PoolHandler.addQuoteToken(10573174300240611, 6533166142938008061514668085599, 6641521052794384986716994908006, 1000057175288732094);
        _basicERC20PoolHandler.transferLps(24495191220467426815376214680354715318620115341898882186851930878237, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 3580273083272368012319376153679, 3, 139472833439292252552777284750309249598390885616377173335359);
        _basicERC20PoolHandler.moveQuoteToken(3137120365091873707121671, 3770305792242247571057047021222, 688073744140267036874581419021233769495951461622902378777029232481467137, 2727549361961145420040936341265, 912967853890579112467883629158);
        _basicERC20PoolHandler.removeCollateral(1, 702962994960136423450962369774954940760416938573495301567315355168, 3, 76147649129026008);

        invariant_exchange_rate();
    }
}

contract PrototechRegressionTestBasicWith50BucketsIndex500ERC20Pool is BasicERC20PoolInvariants {

    function setUp() public override {
        // failures reproduced with 50 active buckets
        vm.setEnv("NO_OF_BUCKETS", "50");
        vm.setEnv("BUCKET_INDEX_ERC20", "500");
        super.setUp();
    }

    function test_regression_prototech_R9() external {
        _basicERC20PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639932, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 311855305968157744570601481773144);
        _basicERC20PoolHandler.addCollateral(2, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _basicERC20PoolHandler.removeCollateral(169050319556909991808, 3, 0, 1);
        _basicERC20PoolHandler.addCollateral(1004201281585420667067519110248, 7102026478996272106877444035857, 1000005176609260307609491, 3305068122278678061826709665672);
        _basicERC20PoolHandler.removeCollateral(5126250508003894776370908264788, 491360638543797591635259813352, 787983051556723253156194660814, 3320088216653581211669326645577);
        _basicERC20PoolHandler.repayDebt(12396923902833375051988245672959, 7853833558731273234852069656215, 4854998063651887910481309782641);
        _basicERC20PoolHandler.addQuoteToken(22492324757351622016450338305141639519921418025875019955286375595978, 7375145817336195198480525641381057, 4038098431544972508850862464533, 590641590);
        _basicERC20PoolHandler.moveQuoteToken(2, 18642700475706059316512354602605761623058115872316, 0, 389852391755003176683454195550428602558533101523111398325617912, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _basicERC20PoolHandler.removeCollateral(183508, 4655513824786435541548325526158, 6727168359250653708446790113706, 689384358901091345705449093185695413140861121050633943735045187092801409);
        _basicERC20PoolHandler.removeCollateral(887908587686943510167377721632, 459811254525365132505830027215, 4833907401013214004421139781796, 353362243998154774896346551976);
        _basicERC20PoolHandler.removeCollateral(2, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 12898304536022767664608434174578363454046958904043510776692055820203777739, 115792089237316195423570985008687907853269984665640564039457584007913129639932);

        invariant_exchange_rate();
    }
}

/*****************************************/
/*** Liquidation ERC20 Pool Regression ***/
/*****************************************/

contract PrototechRegressionTestLiquidationWith50BucketsERC20Pool is LiquidationERC20PoolInvariants {

    function setUp() public override {
        vm.setEnv("NO_OF_BUCKETS", "50");
        super.setUp();
    }

    function test_regression_prototech_R5() external {
        vm.setEnv("QUOTE_PRECISION", "6");
        vm.setEnv("COLLATERAL_PRECISION", "6");

        setUp();

        _liquidationERC20PoolHandler.takeAuction(115792089237316195423570985008687907853269984665640564039457584007913129639934, 1, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _liquidationERC20PoolHandler.bucketTake(1, 44461073860243257956329708045865382381622555748477789302722, false, 0, 79347249036400230858899360483216604358272416528);
        _liquidationERC20PoolHandler.moveQuoteToken(2, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 0, 3468248190431594592925185332382922, 3);
        _liquidationERC20PoolHandler.removeQuoteToken(2571, 29969932493659093579519920003174531009094912319404669505414364044045886423040, 10590, 5151534821115945192353164396480956473511573634899664160920884112447096424265);
        _liquidationERC20PoolHandler.addQuoteToken(76329009890, 2, 2, 1674344150413686970531450343526);
        _liquidationERC20PoolHandler.takeAuction(2, 2, 179117141720001013602245162251826270509403099827771, 706945742363711658875079945979959946928029538714449846316257823749420726580);
        _liquidationERC20PoolHandler.removeQuoteToken(1181282925764360404276943162707598106995676, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 391477748674803396321030233163086423661214769);
        _liquidationERC20PoolHandler.pledgeCollateral(55400, 2984075702, 2839);
        _liquidationERC20PoolHandler.kickAuction(3285505261586, 2390890078691961684256746925213816912737812482917, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _liquidationERC20PoolHandler.withdrawBonds(69064799185578049928162507577850320714069641703745944312650055827195794732674, 20761, 11569);
        _liquidationERC20PoolHandler.repayDebt(1, 1507729902546837970557030645551705998292433406008323392687486, 255139);
        _liquidationERC20PoolHandler.failed();
        _liquidationERC20PoolHandler.removeQuoteToken(847108075881, 42162244106064982390, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _liquidationERC20PoolHandler.pledgeCollateral(1139872047305319828329319702900629531630147801503024602238950376239270491, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 661230912199721);
        _liquidationERC20PoolHandler.transferLps(115792089237316195423570985008687907853269984665640564039457584007913129639935, 372744813196399714519399926917647299094014976270437803, 2820097493008818092337602368055496904404410450846957902300803247165784, 173467464882758185083557, 11482305045332324833614739919808727240718678);
        _liquidationERC20PoolHandler.kickWithDeposit(0, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC20PoolHandler.removeQuoteToken(44196108561, 959859487311170472139557427, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC20PoolHandler.drawDebt(1312093315543461913781047720589269967180454, 221271430054517801486904020700382587418626242738, 14016013892798531558012100646932474885842079882403824111180458899503053382);
    }

    function test_regression_prototech_R19() external {
        _liquidationERC20PoolHandler.bucketTake(3, 146429783616384180849592991936019650523314, false, 53139180002, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _liquidationERC20PoolHandler.removeQuoteToken(3, 59725457124377207483, 910945517205681107614835808699209805953219515717967553, 16387895106486345806715656347485125396892333604619688726755178430335);
        _liquidationERC20PoolHandler.removeQuoteToken(1000561672232527661686486, 87873523925062603086237824606930, 202413146459819720155430314143, 1123542634173226255528132406942);
        _liquidationERC20PoolHandler.drawDebt(409283853852391483985288776289, 4194592198347684180157520303517, 999967850134954057303732);
        _liquidationERC20PoolHandler.pledgeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639935, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 1124393109);
        _liquidationERC20PoolHandler.moveQuoteToken(1000020339815077618920000000000, 8097325768103315778599144912870, 1032792963286422367947261, 8665401249122512093765629687, 36601418513795);
        _liquidationERC20PoolHandler.addQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639933, 1, 2519054241350621417746359966858813, 44562767757099250587166607855848);
        _liquidationERC20PoolHandler.bucketTake(3, 115792089237316195423570985008687907853269984665640564039457584007913129639934, false, 1, 4568712686826639834090501);
        _liquidationERC20PoolHandler.moveQuoteToken(789063145184450559739706996021388133680023330229784336740638454680268959, 450594962923948238540000000000, 1999999999999999999999999999999794644453611705, 8465193686110166937589557539901, 10339587912398321821943572821449);
        _liquidationERC20PoolHandler.bucketTake(37441200799886, 32888100569498, true, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 1);
        _liquidationERC20PoolHandler.pullCollateral(522219313872608839, 1, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC20PoolHandler.addCollateral(0, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 15968194698742);
        _liquidationERC20PoolHandler.kickAuction(1000057132268475867127974, 7204555709397916016183356689085, 1419376713890394934526032027353, 6632757565220436491095858059742);
        _liquidationERC20PoolHandler.addCollateral(2329891825399834443530000000000, 1003265591359947213, 9336120550484473, 1021215461314647625940397847086);
        _liquidationERC20PoolHandler.takeAuction(8184428443828266349213692016358, 2048797100914327299264373216830, 989515595429036610692955614559, 250424601044133382354442);
        _liquidationERC20PoolHandler.settleAuction(2, 33481369021589, 149148710039007591636845895037427260230281645143162979, 3);
        _liquidationERC20PoolHandler.bucketTake(1218715631377785649651184211362367434156064694629796763664, 689, false, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 134330043710534800159375285894422663336139057491);
        _liquidationERC20PoolHandler.pledgeCollateral(19599062340875527676405566865, 91195259341996654004892, 5353044051101867084751811959365943968156246697209055040627196888717406153503);
        _liquidationERC20PoolHandler.kickAuction(2, 0, 3, 1);
        _liquidationERC20PoolHandler.pledgeCollateral(40770172449844004547001578055579347601994086493351, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 52122230885206760929105461807278);
        _liquidationERC20PoolHandler.removeQuoteToken(195507411380126215099113528092083546010733792798227219281, 1, 144759743046128481044536244556095243362045460899921494302000436956240, 1);
        _liquidationERC20PoolHandler.repayDebt(0, 2473861788278577456552751246563684239979014885018476787001, 1);
        _liquidationERC20PoolHandler.takeAuction(275653185531903385984289007, 974005867492267922112333498, 39422625832217285748680294398, 632493824590115665210000000000);
        _liquidationERC20PoolHandler.takeAuction(1000000000006003053, 2156019376206333175397003792224, 13525679699098751385619866801462, 5883059969726926208070021166571);
        _liquidationERC20PoolHandler.addCollateral(38106769140065340496445941148921, 914446861396065494494774492712, 132105158784728224915354076868436, 26484264067426313892760182056);
        _liquidationERC20PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639932, 1532903294790092742021906905570144870578284156105342441629016165274228947, 3, 2);
        _liquidationERC20PoolHandler.kickWithDeposit(2117094175447831677576620378161, 8452721478740162, 10302392823801389709309931842264);
        _liquidationERC20PoolHandler.repayDebt(115792089237316195423570985008687907853269984665640564039457584007913129639934, 2, 9681449122811687478019129425564610008133337660494);
        _liquidationERC20PoolHandler.settleAuction(1, 3, 13084269823973179053980426994278720150378474483498343876526136951, 1098273546995278229442622620282361570906);
        _liquidationERC20PoolHandler.takeAuction(1969381645399570394974017447775, 4744897916139589403209196971356, 1000021968166020712, 5185393015585021259329084663473);
        _liquidationERC20PoolHandler.drawDebt(76676614927238608144749396067, 207908075327053809457875609120, 5312104895695434926933369270489);
        _liquidationERC20PoolHandler.kickAuction(7806675018592113033000000000000, 999997831669241209869280131288, 12822190641844681496401516853821145256035067398014485773459521943310607070009, 1000021840331763877);
        _liquidationERC20PoolHandler.settleAuction(32893479572441619603910, 3667163205960758751258550446232, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 112677600365768362356667964427635034961901414781);
        _liquidationERC20PoolHandler.bucketTake(271326550775423829066412371, 125977291045448523722777513534, false, 5331386135933959240490915718072, 806795195469399158646250180);
        _liquidationERC20PoolHandler.drawDebt(20527553681289916947572802276, 4664834305984031275914089502221584833255872145935283437982449118557609, 319172407835010863181101104823);
        _liquidationERC20PoolHandler.transferLps(2, 2, 441790021479867017440282018578944757817783, 40299500021407765792227609483690, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC20PoolHandler.drawDebt(545696220248709416145202921679168578733470634910168, 3, 9090433724610200571679232754233638373205942356292885722961721968173115);
        _liquidationERC20PoolHandler.removeQuoteToken(2, 2773914119445664388816637807739037, 705969983610056301460550338712787128086897813740796386934289, 1913665014180278309727171088862194829498208604);
        _liquidationERC20PoolHandler.removeCollateral(2, 1, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639934);

        invariant_exchange_rate();
    }
}

contract PrototechRegressionTestLiquidationWith50BucketsIndex1ERC20Pool is LiquidationERC20PoolInvariants {

    function setUp() public override {
        vm.setEnv("NO_OF_BUCKETS", "50");
        vm.setEnv("BUCKET_INDEX_ERC20", "1");
        super.setUp();
    }

    function test_regression_prototech_R14() external {
        _liquidationERC20PoolHandler.pledgeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639935, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 1045283732897280077977596116159060);
        _liquidationERC20PoolHandler.kickAuction(115792089237316195423570985008687907853269984665640564039457584007913129639935, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _liquidationERC20PoolHandler.removeCollateral(1089197613477172211, 105352650683034090563275765825, 11810594509050274009030767697775, 91269754687468399930268328091);
        _liquidationERC20PoolHandler.drawDebt(955975249144479799615940916, 1000086429807315310919688672226, 1000088891566240487);
        _liquidationERC20PoolHandler.withdrawBonds(1, 47464, 188016512715921697789522756);
        _liquidationERC20PoolHandler.takeAuction(1075108155158470036091008441, 5169, 4703895204617542606263244620933, 3413473555532362172070078928158);
        _liquidationERC20PoolHandler.pullCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639932, 218144672023000948852471957, 52287169014650612230758253417322510208);
        _liquidationERC20PoolHandler.settleAuction(707712790443741119278541669, 1000000000000011976, 11109718643799257037015728693177064491, 6661376693685301);
        _liquidationERC20PoolHandler.moveQuoteToken(3217799421443813786836311728546, 100744623363915008852413768042, 7947161418347938779114543502673, 17387634547663469711, 9641115114843105394259304928299);
        _liquidationERC20PoolHandler.kickAuction(1043964740805560185, 10997941419135701421811977981195030955461296382978008, 1764506756615469022006198801213, 54697);
        _liquidationERC20PoolHandler.bucketTake(115792089237316195423570985008687907853269984665640564039457584007913129639935, 0, true, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _liquidationERC20PoolHandler.bucketTake(18079561868503801148827086313585216269, 1143351222507939978649521713192, false, 6912342578038603657740259502868, 4341871342926188582983132153727);
        _liquidationERC20PoolHandler.settleAuction(1176335039595079973169776816688865808433168167657255589208318, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 0, 1848578295031294606201848);
        _liquidationERC20PoolHandler.removeCollateral(3451429018663920472406618395015, 1883037113768569214171044103972, 787979413190396344510290210411, 5827639256477481821304107405094);
        _liquidationERC20PoolHandler.repayDebt(32438373817866855382318314952712823748696498656747820945548467401015575161, 0, 1);
        _liquidationERC20PoolHandler.repayDebt(3, 108274017585555343196290658891949454137524705150013706821570027345597, 319694013768836648571941255329745382);
        _liquidationERC20PoolHandler.pullCollateral(19152501856317760612030008286494399122, 3403206, 3516519516727078114026472844348015401520732225808158194070531779069748449454);
        _liquidationERC20PoolHandler.transferLps(173763286188458336504841232718, 3479, 4014063603504254984625719147764, 2705347815448343693195072441066, 738551304469825531629556855554191990766121056381040968832432955336373297);
        _liquidationERC20PoolHandler.pledgeCollateral(3, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 323472276973268626767057515539726598718114572669690016002127);
        _liquidationERC20PoolHandler.drawDebt(6658333661681415390307276379333, 787976855430878023437821309781, 1057774872717662644210512864);
        _liquidationERC20PoolHandler.takeAuction(708905998348628863, 1205460519800927279541715701461, 24974680943635276468286499113288031466, 6295292934066094033224245867678192959);
        _liquidationERC20PoolHandler.pledgeCollateral(8587405532382206624822435251495790223, 787984639339761028639133986620, 639072962077245580373890868148585602801);
        _liquidationERC20PoolHandler.kickAuction(3533614812039974364398770222923141407673372115373475556300508205295555602821, 2211834385698104709, 3986432838797971765456244585713042939200337363974936534947601528, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC20PoolHandler.drawDebt(833456799849227989574029348510727057770682495182154148907457844249742169, 636606576607911532307642036021392717733327, 3);
        _liquidationERC20PoolHandler.pledgeCollateral(1, 1062207403215367539082622628519069597631504176635, 2918789219156094647885784495254091873945767691738373);
        _liquidationERC20PoolHandler.kickAuction(1000000000000016807, 575298581242494713515309017285, 5683048945896360420472443582, 3670048475066032349596240800565);
        _liquidationERC20PoolHandler.takeAuction(10125613912, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 0, 34030511047250794421667915966334887944305627971168573958040289589537);
        _liquidationERC20PoolHandler.drawDebt(115792089237316195423570985008687907853269984665640564039457584007913129639932, 1028057047711490714866142404174386737, 822525938648944681582774763867206);
        _liquidationERC20PoolHandler.addCollateral(19134006140420797983223970, 41159415616228193130838450343911373, 257760838, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC20PoolHandler.takeAuction(1992638818131792122197816480094, 1000450027106720182, 2054180695254726143794521688822, 8621591601296418324085337727355);
        _liquidationERC20PoolHandler.addQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639933, 166254697620520187, 604810734439029842994925605858422656275684293944376110703028189882039826, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _liquidationERC20PoolHandler.takeAuction(115792089237316195423570985008687907853269984665640564039457584007913129639935, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 1317732632821109619154353614124374542810361783909821174242498436414553230456);
        _liquidationERC20PoolHandler.withdrawBonds(335333375668256971771169547246945618747042, 140419718384672266235157672742303972363218056323, 430128887626388368351032773152357359740109);
        _liquidationERC20PoolHandler.addCollateral(1021111957831871028, 2646134295074933336615103163075, 1000015041670256994, 13529549576428373417211086245998);
        _liquidationERC20PoolHandler.withdrawBonds(3911326196324434203023053058116910688, 1123079414731248829176511663274, 1999999999999999999999999999999538005735918973);
        _liquidationERC20PoolHandler.transferLps(40919636048649881328203809121167356565783174094684, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _liquidationERC20PoolHandler.transferLps(50050926330915153219686807905682217901423578026756601346238, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 90813654625829766860625631718770558326383083924988881952290399923361527077, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC20PoolHandler.addCollateral(1787572272045622669925411842478, 2876642752539595897886654183035, 1000035447746281798, 1000107647783847884);
        _liquidationERC20PoolHandler.repayDebt(1797225133307500830000549410575, 226028080505269598211019, 1071666518921006268764553266805);
        _liquidationERC20PoolHandler.addCollateral(2108070130514518187776, 2, 11, 28821269219189634009935972616873915789136583);
        _liquidationERC20PoolHandler.pullCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 681002066038338357923623733806);
        _liquidationERC20PoolHandler.addQuoteToken(3323733645828764244783800401948, 1025246565380062903799492448802, 5504962058656769867822798034, 4601370545578631412322935527072);
        _liquidationERC20PoolHandler.moveQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639935, 6532731000244171849848344848723915, 34480671929303814720, 44248794276583082784954806503925522851829741440166, 750188936923231745218533301001262200166527749923536547908073497523578773);
        _liquidationERC20PoolHandler.kickWithDeposit(2004579093724976231508186677767, 10999812472107451, 2008170300);
        _liquidationERC20PoolHandler.kickWithDeposit(115792089237316195423570985008687907853269984665640564039457584007913129639935, 924656886714369235845431724622202358995089, 1241197474375783649486568362713407);
        _liquidationERC20PoolHandler.repayDebt(3, 1429272782580961788459421912268911305779790482389159, 3601089186740122417890035855513892236234856106231629744244671436287276039218);
        _liquidationERC20PoolHandler.addQuoteToken(2, 837936031553845712866764572567, 7444859491, 9554871296787595280431542930104391508161683437167829377);
        _liquidationERC20PoolHandler.settleAuction(11288350957475559598229201068, 9235370281345232721947056843407, 13766347507771284991127856221265468791, 11423013003238370);
        _liquidationERC20PoolHandler.kickAuction(3, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 0, 13609205814408857668195588);
        _liquidationERC20PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 5607391544166590653521730414106271198505153054479);
        _liquidationERC20PoolHandler.settleAuction(115792089237316195423570985008687907853269984665640564039457584007913129639933, 2, 1, 538276022700725249118842077161541536416325353756948733408774042610485);
        _liquidationERC20PoolHandler.addQuoteToken(24200313402386856980969973824473504415, 1534127906744820785251257724755, 10908292002391491450626838948900, 381119361819659497022531458134);
        _liquidationERC20PoolHandler.settleAuction(2, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 3, 280145587772497030690083574583765022942752158582338060);
        _liquidationERC20PoolHandler.addCollateral(4248313671129354572529613010557, 1000013772404413814095645, 908912589627681159094929720992, 786715782023128375817189567529);
        _liquidationERC20PoolHandler.addQuoteToken(1196508967565271445272192903855831962, 2670729746496083825680399325926465941942282611465938679487069, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 501771063841346860595845326951947173080053689568891862);
        _liquidationERC20PoolHandler.addCollateral(5270026010540048274255918399903, 383305364190022223873362288913, 1000065802255498019149759564389, 7377387611266094004162109098246);
        _liquidationERC20PoolHandler.drawDebt(458979861949464842770034210431322854417848, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 3935480602505176986985525941367301218333802072650913343066251);
        _liquidationERC20PoolHandler.removeQuoteToken(2, 98400424509682741197038976620728681574, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _liquidationERC20PoolHandler.addCollateral(999437411300728470576989688, 1993185801857229581395593384369, 31813091015360993178983172034, 1266641389690229740009643208724);
        _liquidationERC20PoolHandler.pledgeCollateral(1787007805467465227923718735991, 5393120746062957904527097649141, 1912703283384720471225931413726);
        _liquidationERC20PoolHandler.takeAuction(192604336920797431114934624890, 6101578548568682359333222351973996246816, 105730532527, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC20PoolHandler.transferLps(1000105959518389446, 2044727637238278861994725788899, 5826800130471596549929629281119, 1000003028083545390, 1000007928853885115);
        _liquidationERC20PoolHandler.kickWithDeposit(3228023325993422277288130539062, 39505413210895824789729350063, 6248449210465815409795990278848258783);
        _liquidationERC20PoolHandler.takeAuction(6191101619230344581079117178723, 4720814275041204535087465527278, 1000005163387036068255354, 1089919911498364436636276791);
        _liquidationERC20PoolHandler.settleAuction(1, 391834874104811301350332136523278679938043797003744848419865685493, 2655150871419339452091087802566556763831966253311897196651839700615, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _liquidationERC20PoolHandler.settleAuction(384198234746339048, 8983453236928890625815972000289386481374054419, 1, 2);
        _liquidationERC20PoolHandler.bucketTake(62280038633284170435667601963901908787370037914628116709, 1753048395192371403728601770904983466, false, 1, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _liquidationERC20PoolHandler.withdrawBonds(1, 2863236521813569482072940, 2752637712679534783566647394825319470177317674237495767379237429164437027);
        _liquidationERC20PoolHandler.transferLps(9156232042361777160531072875354, 31670, 31902202800029027722755344313631852660, 1000452322800221691, 403645654981001493079060415966);
        _liquidationERC20PoolHandler.drawDebt(4601641345744424115307784126905, 8868709093573005384445224260236, 11251663237689041298729239402751);
        _liquidationERC20PoolHandler.repayDebt(181993602391278453598823467974416687293623529904720359342805408117754153674, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 1092493364674129781948855356);
        _liquidationERC20PoolHandler.addCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 0, 1392575545167898633155356733386436569812507539660919771985);
        _liquidationERC20PoolHandler.transferLps(1001103152942047407128236416, 8411314671061391115709224478810, 10414301895577625586615256336396, 6040933700431230503431540548715, 8267969183841027306213959299911);
        _liquidationERC20PoolHandler.takeAuction(635285680275723692289448379180119809691822929284021639331816463, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 21756043279069684263673812);
        _liquidationERC20PoolHandler.moveQuoteToken(1831266681, 1000146604043416963, 1002174561478012908323019664, 1707591886, 102661865136966498821878628);
        _liquidationERC20PoolHandler.kickAuction(1082996175271372137833467946, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 6508444497989592201503937927833829371286945005924618342859658355737);
        _liquidationERC20PoolHandler.kickWithDeposit(1230353598539171369624843805065, 1007971129190814463, 1002908373963252229);
        _liquidationERC20PoolHandler.drawDebt(115792089237316195423570985008687907853269984665640564039457584007913129639933, 136437801288778798184008585174211646445246862016565292176, 172763808072301);
        _liquidationERC20PoolHandler.takeAuction(593644314923590037002843454552688531686186697552207486412073918222, 534505298241021630045631723960787270860482313902491037942617, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 2);
        _liquidationERC20PoolHandler.settleAuction(3, 42774741220449, 642089743490606640491580457089160539049478812410205761603, 0);
        _liquidationERC20PoolHandler.repayDebt(5820895288269028894719004867798, 5825891551211335729697101148238, 1260944463679734247007348186609);
        _liquidationERC20PoolHandler.takeAuction(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 3);
        _liquidationERC20PoolHandler.takeAuction(0, 0, 360144937089358012294285485609898438276269, 72627532);
        _liquidationERC20PoolHandler.addQuoteToken(986972999034460471, 1000028509392955924, 648151825729755699620034936, 9420327580080996484339223338521);
        _liquidationERC20PoolHandler.settleAuction(2460989443290938169170344407550648131, 999997014290027250383268796817, 12947087505965474262773861205294358443, 13959052182721488072138021584677);
        _liquidationERC20PoolHandler.pullCollateral(1601366803286368357832451593484, 9520302142806509186086342113039, 1025638029347460318);
        _liquidationERC20PoolHandler.removeQuoteToken(255281350766042539272854584, 949655629175075470884773602122519860145529, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 99955760662301602045685);
        _liquidationERC20PoolHandler.kickWithDeposit(115792089237316195423570985008687907853269984665640564039457584007913129639932, 23803730325876271598225398589164165071391238917086398440672206534088, 13773175627480392170176677304581555977912896463);
        _liquidationERC20PoolHandler.pledgeCollateral(6220309756903282813565519525679, 1074271152139548387, 2088373590283817852620400777692);
        _liquidationERC20PoolHandler.bucketTake(3, 2019110, false, 99047382297, 3647);
        _liquidationERC20PoolHandler.repayDebt(42270049297035793075830006273990793285158130811655226089, 13244551272304785459570982429077356278479, 78731490663129812696186448231062);
        _liquidationERC20PoolHandler.settleAuction(115792089237316195423570985008687907853269984665640564039457584007913129639934, 1040823788950361622346416391283718914974, 0, 0);
        _liquidationERC20PoolHandler.moveQuoteToken(1446655488748210897277015847091, 5756071265626575851764704750447, 2000388974857112919241098174061, 5711672904098674939860636, 943598808261116126190873952448);
        _liquidationERC20PoolHandler.repayDebt(2, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _liquidationERC20PoolHandler.bucketTake(9886670204625939070824180743084536373, 695270525751800038932660966009262667139907338924625168551325103829430940, false, 801338109747621891208317361, 11307140845722806909023438759447);
        _liquidationERC20PoolHandler.moveQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639932, 299060495, 88392817097949409521503985805774101223027607249429, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639934);

        invariant_bucket();
    }

    function test_regression_prototech_R15() external {
        _liquidationERC20PoolHandler.bucketTake(1385052599556021215003977673406, 990917882033313106213081300998, false, 3058865338667682331615618172106, 6457836522988788837151813736424);
        _liquidationERC20PoolHandler.takeAuction(0, 383, 20247295629524574940066032483251481926306576215340523651308, 10099470924035142355288374);
        _liquidationERC20PoolHandler.kickAuction(25882820578115540341160135353646809801338805855958363098678418646245833410, 354497598826560417181664483819212548533864578180468, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 17630718222372807828715462032887247);
        _liquidationERC20PoolHandler.bucketTake(115792089237316195423570985008687907853269984665640564039457584007913129639933, 2, false, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _liquidationERC20PoolHandler.repayDebt(115792089237316195423570985008687907853269984665640564039457584007913129639932, 2, 6409836001091911315999904045133712);
        _liquidationERC20PoolHandler.kickAuction(115792089237316195423570985008687907853269984665640564039457584007913129639934, 22533775154711735056881906809804476232953914203441931257415993903218632803, 3, 0);
        _liquidationERC20PoolHandler.settleAuction(1788967492023312321936125553065828045965563466653, 1668386941953668372731559, 187664265608882673953569512699, 20401978651528095526014704549956935022725369089);
        _liquidationERC20PoolHandler.addQuoteToken(394301716671595233798119361773279689852008758009031969401337575, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 1, 6580558083566173);
        _liquidationERC20PoolHandler.settleAuction(1000026360230184623608201, 3445033123318933827907509914363, 8341568484289776315188972577996, 97743170805643825076665511);
        _liquidationERC20PoolHandler.transferLps(22608024113365095905584131452586028419270976193494306118281696290898985, 4461392298422715704774948, 2, 7846121570888180, 331392658758838563647203297249878207);
        _liquidationERC20PoolHandler.repayDebt(11698528811210192396351422646626, 2280035964984916837444558076982, 946922613349713677617598738003);
        _liquidationERC20PoolHandler.settleAuction(721541049170869524534845911477519041194899408936855489382846493028286662695, 92565402695990540562562919637, 1004806469796271346446984441011, 412399875357809146503163133);
        _liquidationERC20PoolHandler.kickWithDeposit(115792089237316195423570985008687907853269984665640564039457584007913129639933, 656300418695953408530813878943170659, 1);
        _liquidationERC20PoolHandler.takeAuction(23167766422813360944322594861698583030, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 18371215130007, 154042139961746405);
        _liquidationERC20PoolHandler.removeQuoteToken(16581130443054062792053099565786, 82006613552073764251704758982666586639757573675137319445886509306574244670174, 399503514902688198786683762902, 1584974834931813176157302188001);
        _liquidationERC20PoolHandler.addCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639932, 756289706172057271129663005793149327528967350131125151435120252, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 3034979985391077148518907493258006498774414125002734091810702534231056276);
        _liquidationERC20PoolHandler.repayDebt(6654960686622131769183103900894, 155283068073448285181394986660, 6086045371597712528227318934402);
        _liquidationERC20PoolHandler.pledgeCollateral(3743769722231122165591523578230, 4500045263587737169171865251275, 5072070803320573920497012264481);
        _liquidationERC20PoolHandler.kickAuction(1000201037552821841, 8220654264447126154453009315190, 999999794183687144539960, 1000113972004784141);
        _liquidationERC20PoolHandler.drawDebt(281386195115693375966709207, 3901581716893502478060756691606, 35384);
        _liquidationERC20PoolHandler.removeQuoteToken(3, 0, 1243430, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _liquidationERC20PoolHandler.bucketTake(97345306443579698471872863296731644454017981112310798743, 5097744324262305618803451333516871213204886788557904266905027885950348, false, 15976607071872348505532550924741413111663206793776080940491903785, 0);
        _liquidationERC20PoolHandler.takeAuction(115792089237316195423570985008687907853269984665640564039457584007913129639935, 36117836052233398260956981148387392517, 158089829806239236878783692384690887729226316917813242, 3);
        _liquidationERC20PoolHandler.bucketTake(439745608561618692346292483450499249047450803078311, 10547674864087612574890602963119232697, true, 306357957930947756827036148861840, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC20PoolHandler.kickWithDeposit(10495414043, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 0);
        _liquidationERC20PoolHandler.removeCollateral(2028613, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 1, 577661336610046132410646096489019863);
        _liquidationERC20PoolHandler.kickAuction(115792089237316195423570985008687907853269984665640564039457584007913129639933, 514110685473872, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 2);
        _liquidationERC20PoolHandler.takeAuction(20673646728439025426136023323770124885, 675549037640195962340401361, 4219316359517260616958832563315, 5361358460803438);
        _liquidationERC20PoolHandler.pledgeCollateral(836154626029672691412606981, 999995397459114661347661, 17738258297094895528175599087533);
        _liquidationERC20PoolHandler.kickAuction(2820798244021991794430513123516028345, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 1103681980234531514393212784, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC20PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 1, 49688976461470241);

        invariant_exchange_rate();
    }
}

contract PrototechRegressionTestLiquidationWith50BucketsIndex500ERC20Pool is LiquidationERC20PoolInvariants {

    function setUp() public override {
        vm.setEnv("NO_OF_BUCKETS", "50");
        vm.setEnv("BUCKET_INDEX_ERC20", "500");
        super.setUp();
    }

    function test_regression_prototech_R16() external {
        _liquidationERC20PoolHandler.addQuoteToken(222824056091539352103099518518, 6908422496652948227271391533841565559925821938589013282380131207858790559, 854363592005599904841121550660184017, 867721758570404399564681631750325440612);
        _liquidationERC20PoolHandler.addQuoteToken(113304447994612032591102229246041934562130844266200097729476379895250320001, 250727017149033100, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 17887);
        _liquidationERC20PoolHandler.repayDebt(839990245840537306736956875050236745206700673547262961260674089976522358, 10279420159251068418574458724579, 5179038749702114880438683177665);
        _liquidationERC20PoolHandler.drawDebt(105463852237945978654413587679529447907143160831989290368397, 217830913061103073772894479062250419406379446492696510304742234, 16823017451486653335804037);
        _liquidationERC20PoolHandler.drawDebt(65560352226836288671650433936821869080009956276359574, 2, 272341973229250323501602040);
        _liquidationERC20PoolHandler.bucketTake(185388, 787993503357722422751175746777, false, 49356, 15219683800512975283599883588);
        _liquidationERC20PoolHandler.addCollateral(4895930161, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 3);
        _liquidationERC20PoolHandler.repayDebt(1, 48310169647183411507622994540615605142770642706008658126323, 22218436100678269593421894808879360074309501666766667591023753168667);
        _liquidationERC20PoolHandler.settleAuction(1661455008298629960728171342, 1000028070523539295416133, 1000000000000189887, 6885245340527986);
        _liquidationERC20PoolHandler.drawDebt(115792089237316195423570985008687907853269984665640564039457584007913129639933, 3, 3);
        _liquidationERC20PoolHandler.removeCollateral(4490144, 0, 10485928828330580113025711005901987478167458321501231987, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _liquidationERC20PoolHandler.pledgeCollateral(26392580796650444495425293968335184940157814424160135907639723660, 106988274798026976977279836536472418138643809749820666803121429977606092, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC20PoolHandler.addCollateral(4010451895, 0, 0, 8698070588399420446006298133437);
        _liquidationERC20PoolHandler.drawDebt(787997390534979763658015747527, 75158412324705347529304172780, 34126655123631865258985660589);
        _liquidationERC20PoolHandler.bucketTake(0, 115792089237316195423570985008687907853269984665640564039457584007913129639934, true, 58325228541798219, 46879470386212548896463084421868545681838);
        _liquidationERC20PoolHandler.addQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639932, 1, 0, 2);
        _liquidationERC20PoolHandler.addQuoteToken(15670251649456336657418538321892911066554499791729214493, 1, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 3);
        _liquidationERC20PoolHandler.drawDebt(115792089237316195423570985008687907853269984665640564039457584007913129639934, 141304, 116421204516200424467471207929650287);
        _liquidationERC20PoolHandler.transferLps(145190921232816023182892286, 1485941539225043538397320587314507326067352452158533353618, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 0);
        _liquidationERC20PoolHandler.settleAuction(59187491596573159249736785, 1000037597434362742415953, 1000030080817004171716578, 8033135760671800090451265694419);
        _liquidationERC20PoolHandler.removeCollateral(13541, 161558818314562805641082490823, 25451037223374894068393097185, 11821924003532119629408154513630);
        _liquidationERC20PoolHandler.addQuoteToken(7631483691962568244522447172661, 7394757119628189112940101463722, 1000005918459929031, 170496);
        _liquidationERC20PoolHandler.removeCollateral(10138714927350544265475002383399, 5800502327830269972549365931395, 7186916090471575266361529622290, 936554436414113970624847531);
        _liquidationERC20PoolHandler.removeCollateral(1, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 1, 127);

        invariant_exchange_rate();
    }
}

/**************************************/
/*** Reserves ERC20 Pool Regression ***/
/**************************************/

contract PrototechRegressionTestReserveWith10BucketsERC20Pool is ReserveERC20PoolInvariants {

    function setUp() public override {
        // failures reproduced with 10 active buckets
        vm.setEnv("NO_OF_BUCKETS", "10");
        super.setUp();
    }

    function test_regression_prototech_R11() external {
        _reserveERC20PoolHandler.kickAuction(3, 68017263886196518657592597568504789, 391561788643183098554665799975419927621032623980326545791981800664257724130, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _reserveERC20PoolHandler.drawDebt(3, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _reserveERC20PoolHandler.removeCollateral(32674392097267007450, 3, 5043247569479781482831144425176384301026411256346555484071944213783871926, 9666068);
        _reserveERC20PoolHandler.kickWithDeposit(15294870881675980474825946, 1939850566891179566028893081, 222839557801267197072194071529456340407356681645608724022009618778177372);
        _reserveERC20PoolHandler.transferLps(2, 551418418494458, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 10560412334221668385798571199455341606073161061452049653, 1);
        _reserveERC20PoolHandler.pledgeCollateral(291715309405039431770633, 3, 35769072883750911089537749);
        _reserveERC20PoolHandler.repayDebt(115008, 2, 10975186980133713110093507666382683342951875963592803048343758);
        _reserveERC20PoolHandler.removeQuoteToken(54242526996130584062876906550673950194859373185773833457163845157849133552765, 1057008213483615979503544429310380730462016336265535537357874696602660, 2, 191114204200043065644878523310339750144836);
        _reserveERC20PoolHandler.pledgeCollateral(340249583547187265714297, 2999999999999998999999849225278439119315942552, 74040366507349154451087399537);
        _reserveERC20PoolHandler.pledgeCollateral(5508862967988595212280201259245, 1992236063, 10567352853472569530051954306605);
        _reserveERC20PoolHandler.removeQuoteToken(1000083845405236525690366669746, 1000001975145055194, 1000000000000272352, 12329982860914619394429855305575);
        _reserveERC20PoolHandler.withdrawBonds(115792089237316195423570985008687907853269984665640564039457584007913129639933, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _reserveERC20PoolHandler.repayDebt(136054946128872013516072128171265011423947531437827630853432405364039, 901009, 1269769745448689659194719227650859558055451284524430369333252617603970);
        _reserveERC20PoolHandler.addCollateral(1000136804156782925, 1000000002642628154, 64940579119710573896086349068, 10408341542544129512599014976);
        _reserveERC20PoolHandler.pledgeCollateral(1447546216925212454820453423057821577973367932, 786169022711868114034004615208690677368092510521, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _reserveERC20PoolHandler.moveQuoteToken(412009786630002117218476835375384773211619057197070011247816569669566484, 253528022175382403618255, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 1714204153653468991798616744356147507383002673074);
        _reserveERC20PoolHandler.pullCollateral(3388608753221889345155649363, 18565524669264179729485466773, 519650877954757200207179083185631579543567);
        _reserveERC20PoolHandler.addCollateral(3, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 1, 1);
        _reserveERC20PoolHandler.pullCollateral(145594517578917794728854355529822013162573897265386274, 210676303140, 2636972474755341002428180566072467980);
        _reserveERC20PoolHandler.moveQuoteToken(24974771193022578989876943760626903122990905750563012909041144789237808234496, 1077357129239536676, 92656113424956630848155351, 148152610739895809386101479276, 44534066436026186400561481460473122938977663365070620993148575025560103958328);
        _reserveERC20PoolHandler.removeCollateral(1959573418674022123941421440550, 1663228891718021838447648472445, 327413955292743089096485415, 897972648449070857157384837894282564659590731028105133189128103068767806);
        _reserveERC20PoolHandler.takeAuction(1825641524297325776587, 34151714530101726420079463569, 999999999999999999999920448703384962302900149, 8258246463241893991282394160959);
        _reserveERC20PoolHandler.withdrawBonds(24962389351605589454467052490872760974356824319400619802333156610413061734400, 1342801265029358677245304248, 6364229221939168656733725689634);
        _reserveERC20PoolHandler.pledgeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 22);
        _reserveERC20PoolHandler.takeReserves(64957602305809042594444936666, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 19424195782554541785375928518503362);
        _reserveERC20PoolHandler.addCollateral(8934832001448102239290982269331, 1020678840892282519, 16216811475856102666687227835083, 136478432765116075055429389413340);
        _reserveERC20PoolHandler.kickAuction(1404225511711351474840011375325, 1011232705035968783, 51651020796243107034521787843, 1000051854056421776);
        _reserveERC20PoolHandler.repayDebt(1000039790008541518, 2506444218309527420637993061683, 1054120957092611561872747689864580);
        _reserveERC20PoolHandler.pledgeCollateral(311462314365023949645000989835496274923532, 2, 61176936844486341797);
        _reserveERC20PoolHandler.kickWithDeposit(1000101273847838031, 157894809707323477834797886, 2727109375317708510247);
        _reserveERC20PoolHandler.settleAuction(276377729950432266358152903413, 14172548716610142, 1000001948536906005, 1000046244392625960);
        _reserveERC20PoolHandler.takeAuction(1185053625058600950, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _reserveERC20PoolHandler.kickReserveAuction(413391825423522130231272526072097775954050721658756, 2789336864943890188033782505556643685523516596543298068213041208779488);
        _reserveERC20PoolHandler.bucketTake(469105944427494811992269, 513370839013048444696, false, 558834351850430830179986838120, 7590449482543173112466299776);
        _reserveERC20PoolHandler.kickAuction(4510859837013871607813501552634, 2, 3954809253, 1964545299255776056);
        _reserveERC20PoolHandler.settleAuction(218106621543912116239670936210745149892, 18558293, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 5680830406079446936949164350431667885338042151643924835711737507453136657);
        _reserveERC20PoolHandler.kickWithDeposit(260082352409537343, 1312581023432534908714705852133550877882, 5577);
        _reserveERC20PoolHandler.settleAuction(702842458953962334141165745262603789256754583999726329212501764101101002, 45410512412168471290562328901235453523055965982164466562794499008765674140470, 35212542422299189231403325769, 1000002680559451038);
        _reserveERC20PoolHandler.drawDebt(1495111908659443571640381895279921708789456455352652654863, 104379460254431372828626772816355882116, 1047954941928982449120045350);
        _reserveERC20PoolHandler.pledgeCollateral(53542260366297644747643714539302, 2186031795, 1000032808567703495766701281746);
        _reserveERC20PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639935, 0, 1, 3094144583453159970492795295725019958533862640075416223007940497232896);
        _reserveERC20PoolHandler.moveQuoteToken(1075700541159392609, 5440359610297881209251938443, 54760078766000977066630218397420, 13574108545862816441239051893186, 797172091061708117875791758);
        _reserveERC20PoolHandler.withdrawBonds(1, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 2);
        _reserveERC20PoolHandler.takeReserves(53715122783830583425096730469291, 3457092158425299077737077141484, 408938583423546716736441653689);
        _reserveERC20PoolHandler.addCollateral(2, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 2, 821709322067148644208487800021239);
        _reserveERC20PoolHandler.repayDebt(14443694688090769801300591881509, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 306350800334849604110899208);
        _reserveERC20PoolHandler.transferLps(3368678460568171245862422428815445940399770017679784809206514925855268, 114843572818260703162329056849456030607789971931173720093198317362943454, 132894061162260404149514400721875546305851327054672212, 7570183708096510414463118894794635, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _reserveERC20PoolHandler.addCollateral(0, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _reserveERC20PoolHandler.repayDebt(2901281105747813330220113794552, 1001962791193229324, 1001558037407562762);
        _reserveERC20PoolHandler.kickAuction(165020, 428788306166628362356071, 0, 3);
        _reserveERC20PoolHandler.kickWithDeposit(115792089237316195423570985008687907853269984665640564039457584007913129639932, 102211036, 3);
        _reserveERC20PoolHandler.takeReserves(1012644078658904602, 2719602696882967929518, 1422271821884810608467320703);
        _reserveERC20PoolHandler.settleAuction(34338965, 28251472481804511690577262293910509808909, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _reserveERC20PoolHandler.moveQuoteToken(2, 123002695954740253579724875137137239889, 770431402458707380371670732493, 1123705604428422494577519436556229382227, 1);
        _reserveERC20PoolHandler.pullCollateral(29015892387691231069537738823504, 13333525930767442057356461173273, 1016333012541309555);
        _reserveERC20PoolHandler.kickReserveAuction(49048126082132649972473382830568437912654275474482312331168216843079498334208, 3047047114186436239284195230821);
        _reserveERC20PoolHandler.takeAuction(25505415974190267720534108410702, 41664531784264657672217194854, 352954884931886229651133610536, 8055468309020724141793237097477);
        _reserveERC20PoolHandler.pledgeCollateral(0, 830394890357853460944253251823190168645178871300202, 0);
        _reserveERC20PoolHandler.repayDebt(132331789489792, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _reserveERC20PoolHandler.kickReserveAuction(115792089237316195423570985008687907853269984665640564039457584007913129639934, 594382662304791243424208893916197079029450337301665854080100639196530337888);
        _reserveERC20PoolHandler.pullCollateral(2, 3064021096411600948574746384620512781600863531646574511101360048, 230269793539704528583128403795865439626719583761);
        _reserveERC20PoolHandler.pledgeCollateral(1484430473459408804614132194982245894433212774, 2730342543970034158065961971162285387347873606202141375330352285301386, 73718545491048479990268917);
        _reserveERC20PoolHandler.addCollateral(5362315847583574136123324047690304871245741609059451284655260707081727379777, 2, 368347505762566411506923776131987360237228935005234, 3);
        _reserveERC20PoolHandler.kickReserveAuction(157531550449264520735619216783252938761611, 31907296876934709630927661945038757189531376701857690716571269647);
        _reserveERC20PoolHandler.pullCollateral(3, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _reserveERC20PoolHandler.kickAuction(65547663750489259897462872082496619972729792, 3, 43214774970809842411602457433723823761706379500272930275273834230354280, 0);
        _reserveERC20PoolHandler.repayDebt(298420396402660685479169527635602585, 2, 2);
        _reserveERC20PoolHandler.kickWithDeposit(1, 0, 24431);
        _reserveERC20PoolHandler.settleAuction(115792089237316195423570985008687907853269984665640564039457584007913129639932, 215579530262817742736900035459758520648147732598212753876446458720838163, 3, 29428860698294937135095823760318627117890638944067660683);
        _reserveERC20PoolHandler.pullCollateral(0, 2, 145398756730043991786885064294852169675135555689110159428);
        _reserveERC20PoolHandler.repayDebt(47406693530371259488031252577534167, 1, 3);
        _reserveERC20PoolHandler.takeAuction(115792089237316195423570985008687907853269984665640564039457584007913129639935, 158163173677242025627409532790039077, 641461993, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _reserveERC20PoolHandler.kickReserveAuction(110305576960290871533772090987733271, 3);
        _reserveERC20PoolHandler.transferLps(0, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 8850474774936, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _reserveERC20PoolHandler.takeReserves(49048126082132649972473382830574258669503485163525734353613699540857227575296, 1795615663, 797270798914903075717824331220037801836926969268058676930247170580499896);
        _reserveERC20PoolHandler.takeReserves(8012492449754887785662481708233755752851927083, 1, 0);
        _reserveERC20PoolHandler.takeAuction(1275264766079856029914514891332, 44975840344476641485434221789096750645066066408414103736515031993904774132534, 10564560821808644074486437761514, 7523798686882254);
        _reserveERC20PoolHandler.kickAuction(342347753855458385652746309705, 13909206233285661142752962611359317669616140878592065059572511317897, 2, 3);
        _reserveERC20PoolHandler.takeReserves(1000000002546058918, 1000000000573772939, 9625002220357908);
        _reserveERC20PoolHandler.takeReserves(115792089237316195423570985008687907853269984665640564039457584007913129639933, 1, 45442515671621719572365950347810967990776351222602423114);
        _reserveERC20PoolHandler.pledgeCollateral(224753827728536971046762444954825448569158101726541246735692950917, 585599619636265504760042, 11518158393531357090003);
        _reserveERC20PoolHandler.withdrawBonds(80358382556772265787496, 1058510662282490507866569, 361299725846750532625059425988);
        _reserveERC20PoolHandler.pullCollateral(28251986565121855694130081941, 2219558756, 301850721719235287956021535362536);
        _reserveERC20PoolHandler.withdrawBonds(1264906576535490759433, 1022092060312529085, 9343204050226984044088764727596);
        _reserveERC20PoolHandler.repayDebt(115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 25885709432430);
        _reserveERC20PoolHandler.takeAuction(3097734658325560643740294933952222490175078964529136087231363423566499413427, 1815277275913137970181256981297410123084, 2, 0);
        _reserveERC20PoolHandler.kickWithDeposit(115792089237316195423570985008687907853269984665640564039457584007913129639933, 483117155341572706060353655208802090565624597316406239, 1);
        _reserveERC20PoolHandler.repayDebt(36258729309042588780233007078421, 172403135617492194755, 3);
        _reserveERC20PoolHandler.takeAuction(92645762793, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 1897788667107530791286125223833, 3);
        _reserveERC20PoolHandler.bucketTake(4894484534457679584603026619556, 44534066436026186399651753828646833581584125742510060227867641768910423143216, false, 869120751652553571612835346045203151653190091372070905546937012003604792, 1000000238130294060);
        _reserveERC20PoolHandler.settleAuction(317728, 227179362955179806285060, 2, 9350732633952219612815189363156154678011220890847265287);
        _reserveERC20PoolHandler.addQuoteToken(241581939837793798180990410, 1966879659399530147038021365868, 1000927013126703713, 1000152853304639916);
        _reserveERC20PoolHandler.kickAuction(202009582449393179227031660448, 5090062613197253576797433679661691192600967306, 24021713594303467481777392023, 27);
        _reserveERC20PoolHandler.takeAuction(538647063694983430344138428449, 1000199391870042785402017, 25350917484784866529364703413, 4522027927301724447363726883884);
        _reserveERC20PoolHandler.settleAuction(1597962303, 3, 251830874658, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _reserveERC20PoolHandler.removeQuoteToken(1314004372181758205765752560179345138935240744962170528637621, 152767008602532209023688756332427750810, 33158366711498761763570427726, 433224117867178562113523066784902810558539992238);
        _reserveERC20PoolHandler.bucketTake(312984034944347110298128085200113741508082249118555763500447522, 35408943852595872386125916093485134833795, false, 24283463859497973754333265806550409396611177771846310994625347, 240236487880);
        _reserveERC20PoolHandler.removeCollateral(2, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 505454016486718983890610427950131971129282294813);
        _reserveERC20PoolHandler.settleAuction(1000000004028146657, 1113731294811355647011114890831961770748016638244840, 137164698949707100788650, 902082991863663787637782220009);
        _reserveERC20PoolHandler.moveQuoteToken(4862668562572601747343737032414, 1000052278601791387, 32119863545386263873240, 831938482491185040886936340, 2770402475874422937363325007225);
        _reserveERC20PoolHandler.settleAuction(1905899101290337771352450176791576799306797276, 1, 386881662994101415820988, 2468144417);
        _reserveERC20PoolHandler.bucketTake(97069, 5408678443752846950547820881014432105046507205198050194, true, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 28145);
        _reserveERC20PoolHandler.addCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 99314414077939, 3438425405552395266339680607769483002351890303075605521);
        _reserveERC20PoolHandler.pledgeCollateral(24063050446270811181263384076031372768573915229857053154408785914921628991488, 1000000707192030881, 1000209129452658927);
        _reserveERC20PoolHandler.pullCollateral(5665058830992865849846064893329315665747631256505842, 3879353213128497547743444621978, 999999999999999999629494717962228963240461909);
        _reserveERC20PoolHandler.pullCollateral(1718130788591788172127190803, 2183149924702131335677505683606, 34950498544920587740500);
        _reserveERC20PoolHandler.transferLps(3, 1, 3, 6519047769852674791505, 28451615);
        _reserveERC20PoolHandler.transferLps(1894777010288142116328879933089, 651535208283029243, 1021780869860340899, 788057004445955995747443756954, 20588731652595650866040413506);
        _reserveERC20PoolHandler.pullCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639932, 7032038738561503898717858698633, 1);
        _reserveERC20PoolHandler.kickReserveAuction(115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _reserveERC20PoolHandler.takeReserves(484042514647627029094263765253031321835092865887811310864159916609, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 2553766109490945569934089831410319114330239842164);
        _reserveERC20PoolHandler.kickWithDeposit(2172609388205474181388626715757, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _reserveERC20PoolHandler.removeQuoteToken(8921619308376183678951080796508, 2078246913, 4177987880408904844582810292, 15429288384987019645045725485);
        _reserveERC20PoolHandler.kickWithDeposit(11781052618938700640644036599254, 1000038213163496093, 67916282796181076185539777331151);
        _reserveERC20PoolHandler.removeCollateral(1143800628980991553, 1022518410509668229, 19428154552496484378056244891086, 1002642672980910801985055987355);
        _reserveERC20PoolHandler.takeReserves(152907916280, 3627846406727964749279166835590162933198934681646161785042288306427247834, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _reserveERC20PoolHandler.removeCollateral(3573578273525782012828, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 125101315829103095007478944542083635279703617727, 13702336674147110);
        _reserveERC20PoolHandler.removeQuoteToken(9705081542939251743664727165560567117973359376870, 18462433404451858779328946767820118756227380227, 3, 1);
        _reserveERC20PoolHandler.takeAuction(115792089237316195423570985008687907853269984665640564039457584007913129639932, 1435, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 12968);
        _reserveERC20PoolHandler.pledgeCollateral(2493236366955928276, 25312556492764228789899199712474, 32029977338711159023241808977);
        _reserveERC20PoolHandler.removeCollateral(1, 19721897117483, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 3);
        _reserveERC20PoolHandler.removeCollateral(2241293566734937505175276363409401366719, 56771877726, 17934985603538901292459424036, 0);
        _reserveERC20PoolHandler.takeAuction(56995227568820276, 630685926336985137589980479517559896321480606229585, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 1161998414551494288077145935036127769136915743630036796863);
        _reserveERC20PoolHandler.bucketTake(887230640594776495646815969, 211217185874671213683374414471, false, 2746784248195777002513239916202, 1173618014431183874576913089895);
        _reserveERC20PoolHandler.kickWithDeposit(1000546158555323461, 47874221152991625987706656319, 11679006161031461064410712971861);
        _reserveERC20PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 296487935759914043308724799371385, 95543243954808413040, 12023452877105290767);
        _reserveERC20PoolHandler.pledgeCollateral(4314586062377589861503030464457, 5877213534032805324583454180522, 4225366376309008718147209534765);
        _reserveERC20PoolHandler.withdrawBonds(37527918981538739172507774975, 37371516145672459912677645560775, 22047942460037776119671785116740);
        _reserveERC20PoolHandler.transferLps(3, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 25455213095805058394895303955300204423542524479838);
        _reserveERC20PoolHandler.moveQuoteToken(1782929436098637883696507187392, 1000249723733857930, 44534066436026186399651753830114200575896190259145588393777852009294417048633, 118850829692246175219963676546545, 10000000000000000205577486616447460703611207868);
        _reserveERC20PoolHandler.kickWithDeposit(1998286656055147368231947559845, 610956214948703781675966879707, 22697518059196633056305089417);
        _reserveERC20PoolHandler.withdrawBonds(4940474593378576864955869366, 54105447160137988681610643299829, 106435328042793116026366514465678);
        _reserveERC20PoolHandler.drawDebt(9343300240625133252569515183691, 8001046688346554204294629157593, 18433754406834812860727425462167);
        _reserveERC20PoolHandler.takeAuction(1000307528150182227, 1006694317380190845, 1740122150631751923868669768649424, 6826045375416505496551930097042);
        _reserveERC20PoolHandler.takeAuction(2742144441275151891997, 797858298776227256024272087186, 8654704454838762748449721939978, 1000001518373137281687835860599);

        invariant_auction();
    }
}

contract PrototechRegressionTestReserveWith30BucketsERC20Pool is ReserveERC20PoolInvariants {

    function setUp() public override {
        // failures reproduced with 30 active buckets
        vm.setEnv("NO_OF_BUCKETS", "30");
        super.setUp();
    }

    function test_regression_prototech_R3() external {
        _reserveERC20PoolHandler.drawDebt(2, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 126768300275249757890745);
        _reserveERC20PoolHandler.addQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639935, 995386543778, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 3);
        _reserveERC20PoolHandler.kickAuction(3, 2, 812654262134658424, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _reserveERC20PoolHandler.removeQuoteToken(999999999999999426444582247143509387950866739, 1148181505672158329590024, 1367070079813696596859779764, 1040389191213838886625616);
        _reserveERC20PoolHandler.bucketTake(577389696155710288147167555978498172752201411440998018353873, 1227885260722585562430938444424231, false, 953332261, 1);
        _reserveERC20PoolHandler.removeCollateral(1, 3, 129, 3);

        _invariant_R1_R2_R3_R4_R5_R6_R7_R8();
    }

}

contract PrototechRegressionTestReserveWith50BucketsERC20Pool is ReserveERC20PoolInvariants {

    function setUp() public override {
        vm.setEnv("NO_OF_BUCKETS", "50");
        super.setUp();
    }

    function test_regression_prototech_R4() external {
        vm.setEnv("QUOTE_PRECISION", "6");
        vm.setEnv("COLLATERAL_PRECISION", "18");

        setUp();

        _reserveERC20PoolHandler.bucketTake(115792089237316195423570985008687907853269984665640564039457584007913129639934, 1, false, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 629389231693603343090420846355692908992011);
        _reserveERC20PoolHandler.pledgeCollateral(3, 53169853533896920, 341072661804913043023705374260770467140993540280348);
        _reserveERC20PoolHandler.removeCollateral(111973960360662516013930094, 3352552064337538907813442926490670944060159242614645572852038340224210574, 1, 545333624399376476084257391749349);
        _reserveERC20PoolHandler.settleAuction(1489509608, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 69993407487415616534494782505433645691029338146149);
        _reserveERC20PoolHandler.pledgeCollateral(14144538895041942971455453361, 0, 440773331);
        _reserveERC20PoolHandler.moveQuoteToken(256683046249064075981530998512598309494759277454035029, 1, 1837621038310109860665949216782647, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _reserveERC20PoolHandler.failed();
        _reserveERC20PoolHandler.bucketTake(26584930879530192359355498830460972646562227504808988, 115792089237316195423570985008687907853269984665640564039457584007913129639935, false, 2, 8);
        _reserveERC20PoolHandler.withdrawBonds(115792089237316195423570985008687907853269984665640564039457584007913129639932, 706, 0);
        _reserveERC20PoolHandler.moveQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639933, 448988615907480764066289447553363364964061893704000862417584487, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 3772119655156180605021002310588120706323486627177059, 351386226004590561001892712);
        _reserveERC20PoolHandler.takeReserves(2043306618522797815951284992753538703750711536592125564582, 490216404997999752194488565616055219608572826689336877699923643244785948, 8584693741458);
        _reserveERC20PoolHandler.failed();
        _reserveERC20PoolHandler.pullCollateral(1778135265157395582031101925675, 20196, 1751190732327615354151450454);
        _reserveERC20PoolHandler.kickReserveAuction(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _reserveERC20PoolHandler.takeAuction(2, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 247429948148584627149392386958522289920829622687852166342, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _reserveERC20PoolHandler.takeReserves(361466280750769417526873054117455902300441173869322632522537, 776804005938781782558157697775153837076826088268880722908914, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _reserveERC20PoolHandler.drawDebt(139839408536053689189893101355857, 1, 10528164681253760395808876505656603171974);
        _reserveERC20PoolHandler.kickAuction(3589583182297393115565481914547, 41668, 1380496931690591613721258081, 14181);
        _reserveERC20PoolHandler.drawDebt(9014812045836651946560288041872, 38936, 6000187733701002610517000054944);

        _invariant_B5_B6_B7();
    }

    function test_regression_prototech_R8() external {
        _reserveERC20PoolHandler.drawDebt(115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 78557303174308041778734334615587644696479966881076338654);
        _reserveERC20PoolHandler.takeAuction(3560826864064087890210355804405, 8284292134486334601283507356930, 8612466460181935917307640627212, 94540045629841522013535523);
        _reserveERC20PoolHandler.removeQuoteToken(3999696461585769999000000000000, 1000000341374338853, 1000005152162662430, 7806521369086789769619195765190);
        _reserveERC20PoolHandler.removeCollateral(1000000079710727920, 2442291669205387233489175410142, 3630990179810676200398910095887, 847460621439623237056681561553);
        _reserveERC20PoolHandler.drawDebt(0, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 135985618209023651363845897971107238825);
        _reserveERC20PoolHandler.moveQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639934, 0, 208597913807247634776894828238887885811037126101064385679456085, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _reserveERC20PoolHandler.bucketTake(2, 1260909788762840671758358338778353199817, true, 3, 36549019614253940332754096371716271132897522941003029875258656912);
        _reserveERC20PoolHandler.repayDebt(35713489707331852153713815703838, 54675432681904709533746720, 2393187281228813015650954835646777267961935332);
        _reserveERC20PoolHandler.takeAuction(26816616829814130052736205610, 840476540156857885437388890937788736444087716494897787526447368488481475, 3590891534464757143840616040497, 787976028865965176613015993688);
        _reserveERC20PoolHandler.kickAuction(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 6295930042333642635851406625482065259820298425180628, 5387548394542878692610948494821428577678571736563564372);
        _reserveERC20PoolHandler.drawDebt(232497233829821736118798889764531, 91783648873318007460774349557, 11367075991493289229595783043268);
        _reserveERC20PoolHandler.takeAuction(1068151859416301823588386646701, 52236647465285774440884114254, 16256848650468538085656571831723, 4709147646615738633196664188794);
        _reserveERC20PoolHandler.repayDebt(3098187355648893864949440625884, 1000000170419254742, 4131129972162903);
        _reserveERC20PoolHandler.addCollateral(0, 2, 1232641734641, 31343380291915790650373266756963988847);
        _reserveERC20PoolHandler.repayDebt(115792089237316195423570985008687907853269984665640564039457584007913129639935, 1, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _reserveERC20PoolHandler.bucketTake(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639934, false, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _reserveERC20PoolHandler.kickWithDeposit(788004982292849387186182063285, 1940790819808691432528086343550, 731272264496848181811731492195469346809758718359079122899716176283941283);
        _reserveERC20PoolHandler.addQuoteToken(2, 14624, 617249058149064089429428, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _reserveERC20PoolHandler.moveQuoteToken(1088872909900745236189950617, 15890612102926550116, 4582399149352835659555995253711, 13387122748009058461180259144937, 861762172514412847328248827402360937406130776600887962454677836216335656);
        _reserveERC20PoolHandler.bucketTake(115792089237316195423570985008687907853269984665640564039457584007913129639932, 26346071745620654135109826889565369349143698978199503472136502685355, false, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 153558817743023308082175787142765072463488294348201227240);
        _reserveERC20PoolHandler.settleAuction(115792089237316195423570985008687907853269984665640564039457584007913129639933, 3, 353564705687242420491849365893149102127161943841371651, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _reserveERC20PoolHandler.removeCollateral(0, 3, 240545812974653436443342144824960084537421810224363734800497, 0);

        _invariant_R1_R2_R3_R4_R5_R6_R7_R8();
    }

    function test_regression_prototech_R12() external {
        _reserveERC20PoolHandler.takeAuction(111503320743527282123336088690786562111577764908, 2, 0, 3);
        _reserveERC20PoolHandler.transferLps(3884277863890184536548790232, 1000226692427973497, 362994476962284067579436395, 2066937044638233220791038649593, 1000718160321343602459955);
        _reserveERC20PoolHandler.kickWithDeposit(3, 9667900678314907513590203324738, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _reserveERC20PoolHandler.moveQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639934, 12902846031691147340, 164594771213835727638288874641553370090658299, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 3);
        _reserveERC20PoolHandler.kickAuction(3843665, 25230739321792218739005704, 119030224870754091764872, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _reserveERC20PoolHandler.bucketTake(11315247177110042886106595681008, 8983849823197858095975364450901, false, 2323824412855204507962581562067, 975533577556622775069616347005);
        _reserveERC20PoolHandler.removeCollateral(7233355785594062028431763095593, 6947671390716664781800259361797, 2364108272954507730086190160032, 10301490866825499872294480287093);
        _reserveERC20PoolHandler.kickAuction(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 4112196091939398247421478780, 295698663029349239584995560914499258798038249597687970011386);
        _reserveERC20PoolHandler.removeQuoteToken(471372357907081018126604252647929671966768923565, 9963734961594743791443895502790126625, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 7252780479954101);
        _reserveERC20PoolHandler.repayDebt(108897184340694126196795139755, 36700898877627830213326302979660, 1613376882108016651757155525162);
        _reserveERC20PoolHandler.repayDebt(3, 3802720423467490806103013386144, 7488771414153241121201212980506206179168581345544971233380361604150);
        _reserveERC20PoolHandler.bucketTake(3315852578453946052473353232357091, 1605043837665630743663925097180341306382557697767101130429, false, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _reserveERC20PoolHandler.settleAuction(1000000001926677445, 1000013674615990447, 1000000027239572773, 4384567114608797998762814534076);
        _reserveERC20PoolHandler.pledgeCollateral(616089959610804892994591411, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 3);
        _reserveERC20PoolHandler.addCollateral(7303157612488996292910680158533, 8683517032286817059918980008996, 6571126578955056670521252031880, 3374003485826167929533770956637);
        _reserveERC20PoolHandler.removeQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639933, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 12001122478625899122741648191675138298539480304584223230591082185546865005);
        _reserveERC20PoolHandler.moveQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 0, 17484854529092657540121272054521, 4530198359262192);
        _reserveERC20PoolHandler.settleAuction(258036253576581410588367888874421089641813783163293463885972312089019, 115281501134680248099727350508114429794815738194211762269479998, 1, 3);
        _reserveERC20PoolHandler.removeCollateral(3, 3, 1324087175420087721900611665792906291, 11623313758043884894768017094890080965387351740069);

        invariant_exchange_rate();
    }
}

contract PrototechRegressionTestReserveWith50BucketsIndex1ERC20Pool is ReserveERC20PoolInvariants {

    function setUp() public override {
        // failures reproduced with 50 active buckets
        vm.setEnv("NO_OF_BUCKETS", "50");
        vm.setEnv("BUCKET_INDEX_ERC20", "1");
        super.setUp();
    }

    function test_regression_prototech_R10() external {
        _reserveERC20PoolHandler.kickWithDeposit(9433627986933283125646888807064008232, 221118523365400131, 2465980960817735242955065701468);
        _reserveERC20PoolHandler.settleAuction(2, 1465566755990294261551, 5446397116094743378510145168778507713319320588457, 1528994712721440933750048600830501692959831074023837696043986057926859);
        _reserveERC20PoolHandler.removeQuoteToken(2000454123866580850167634, 18691527695339216532215675622, 2279, 816);
        _reserveERC20PoolHandler.repayDebt(2016357865827986953341016567272966202336117189931, 1, 2849421575152156960123738830798059105666358364513420127963486);
        _reserveERC20PoolHandler.pledgeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639935, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 50295);
        _reserveERC20PoolHandler.repayDebt(0, 109490491610, 12885272574892044);
        _reserveERC20PoolHandler.bucketTake(5735945213, 21744658176442223517969005828038137972068113864460088, false, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 3);
        _reserveERC20PoolHandler.kickWithDeposit(115792089237316195423570985008687907853269984665640564039457584007913129639934, 3, 405985353121972162110815290234023925555);
        _reserveERC20PoolHandler.takeAuction(5603471022574005901436218588047, 1095565616863252189, 3772604393288482751689957579532, 846289097042058312098640953448);
        _reserveERC20PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 187660066730418, 14515486327980056496462485304382041505225);
        _reserveERC20PoolHandler.pullCollateral(4045826300537223, 10970319889760213101329999562, 3107111484864040608557343630211);
        _reserveERC20PoolHandler.addQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639932, 315913732638663056606786571747783579711294, 6878401216970078973504823110738235644526779251414339496339530375349478, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _reserveERC20PoolHandler.repayDebt(399, 1107280160027881571797791241, 1067654314009615425);
        _reserveERC20PoolHandler.withdrawBonds(92677283704171672413890014768704922691759547486188, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _reserveERC20PoolHandler.transferLps(1142320492736, 1039354567763026656227225353183096392431845, 1133565, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _reserveERC20PoolHandler.removeCollateral(620295643990884064052682317994, 3479548635847919216642404792314, 31139391358677713536624267456, 997927134274017863451504696108);
        _reserveERC20PoolHandler.takeAuction(18952705199, 2, 3, 1);
        _reserveERC20PoolHandler.transferLps(16757043981847286919233728140768163175951732998670253725179139479010351816393, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _reserveERC20PoolHandler.addCollateral(312365256502133030922762, 135841143703135003392052964, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 36605945297419456309);
        _reserveERC20PoolHandler.repayDebt(4414047393740330390612480465443, 1083481167464155738, 1000253506048277279);
        _reserveERC20PoolHandler.drawDebt(1120375840534728020787202533497600702079163901298843803557, 30151730334351818850625545607965363703836, 2);
        _reserveERC20PoolHandler.takeAuction(3908244488342148120639586075591, 80927671013312664913023315, 32204941362272668083664757400, 999999999999999675499740883457183941621439839);
        _reserveERC20PoolHandler.removeCollateral(23991626766082576672358660417241244, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639935);

        invariant_exchange_rate();
    }
}


contract PrototechRegressionTestReserveWith50BucketsIndex500ERC20Pool is ReserveERC20PoolInvariants {

    function setUp() public override {
        // failures reproduced with 50 active buckets
        vm.setEnv("NO_OF_BUCKETS", "50");
        vm.setEnv("BUCKET_INDEX_ERC20", "500");
        super.setUp();
    }

    function test_regression_prototech_R17() external {
        _reserveERC20PoolHandler.addCollateral(197678, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 1, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _reserveERC20PoolHandler.takeAuction(51562145830707312640686297651, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 836165679880232494128200621992);
        _reserveERC20PoolHandler.removeQuoteToken(190683739613859309621231179406196668, 11139, 788162131744413660713224679988, 811448245683171905935421896931081471102890553799751606214695987508871465);
        _reserveERC20PoolHandler.addQuoteToken(0, 18914767341883593082145991155549904829, 44258677495029480263163797136568828413100712785, 3);
        _reserveERC20PoolHandler.drawDebt(45100, 1178144011699920740241872509281, 2999999999999999359435960332122772167231077319);
        _reserveERC20PoolHandler.addCollateral(0, 158437481802859724160827237656305132689895025369622199686715, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _reserveERC20PoolHandler.repayDebt(3069152107793872958060141423551, 808812483634812698230213408693559672, 10910887199223584157198);
        _reserveERC20PoolHandler.drawDebt(1034197756, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _reserveERC20PoolHandler.addCollateral(1775015685034573028466471437290, 846386576856622138464602082177, 7208210957564807715107064935860, 1778286732641917607131040964834);
        _reserveERC20PoolHandler.removeCollateral(2805908331646119448797126753653, 1000000005961440909, 1000573584314734880, 2946971324400346613629861406187);
        _reserveERC20PoolHandler.withdrawBonds(115792089237316195423570985008687907853269984665640564039457584007913129639935, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _reserveERC20PoolHandler.moveQuoteToken(1, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 2, 9712643765034225050915962, 46682769043988);
        _reserveERC20PoolHandler.removeCollateral(4643573428474119083863905049096, 1900756136, 1049514370472598628, 1000042388080949436211182);
        _reserveERC20PoolHandler.takeAuction(4604772779040364692966482996, 1018719297903985859204238589365, 6435463, 12936658684489119113561977309306);
        _reserveERC20PoolHandler.drawDebt(115792089237316195423570985008687907853269984665640564039457584007913129639934, 0, 3137717894415033604438675247628414126129278320964911519270210382962);
        _reserveERC20PoolHandler.repayDebt(4377929121944, 4074033843091774413737392892238607292609159924582735309689579134, 73373299140376457406029691325274109293508305634464);
        _reserveERC20PoolHandler.kickWithDeposit(115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 78381888898559226074023822312301457536253423426);
        _reserveERC20PoolHandler.repayDebt(1, 63177319003775515959478, 8930233654559205122776043352670093340626596133);
        _reserveERC20PoolHandler.transferLps(1813082927800051699848948074492, 6673145729685370939756153985086, 1013414194637543961, 1982, 66809);
        _reserveERC20PoolHandler.moveQuoteToken(781486194288092748029626811087512234868929543911, 676294221029944352850660106242863124963677, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _reserveERC20PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 1930099314341338319533334639898281050509992652025001782461, 1508452516839, 623568502028602696617478894480401587727361178155298253716);
        _reserveERC20PoolHandler.kickReserveAuction(149570407593092340494, 82282948842130275597800083);
        _reserveERC20PoolHandler.kickReserveAuction(125251217, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _reserveERC20PoolHandler.kickReserveAuction(1682818450569631049120796210058, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _reserveERC20PoolHandler.addQuoteToken(2844281832676776567928814185739, 1707126801, 5559324577395800135374848021550, 185015888831);
        _reserveERC20PoolHandler.takeReserves(2212572974349486725959816823549, 65001278015320540873390513, 7920602444691416);
        _reserveERC20PoolHandler.bucketTake(87236, 735493735087325306267032990, false, 2112687961, 10884986766744965142824643750827);
        _reserveERC20PoolHandler.removeQuoteToken(4372815925963057165071745490838, 847354478932336986685504238167190226510095108998880221051004591110148400, 37636, 270250573331891);
        _reserveERC20PoolHandler.pledgeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _reserveERC20PoolHandler.moveQuoteToken(2, 5481605097243201612389058622203, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 1, 0);
        _reserveERC20PoolHandler.takeAuction(1000098604066905223000000, 6137465804594685816191305015318, 298823001874298443546, 166082751517351907638663608563);
        _reserveERC20PoolHandler.takeAuction(3269103232793410157099157909026, 847924878688967506199464389378343384685830455787763277241025249039272831, 173, 189660);
        _reserveERC20PoolHandler.kickAuction(26973937893669191604374405808089687043064646451749217910, 1802399752779696, 2, 22835734832020186931842502710079521034686056014480913252043884080019);
        _reserveERC20PoolHandler.drawDebt(1788949561482813948527353928988, 11588320437893175935193248232, 887589095264450171687408509);
        _reserveERC20PoolHandler.removeCollateral(750038135256018104414375339875187123783051180216746391545514087578, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 3, 2);

        invariant_exchange_rate();
    }
}

// NOTE: we may want to put everything below in its own file

/******************************************/
/*** Liquidation ERC721 Pool Regression ***/
/******************************************/

contract PrototechRegressionTestLiquidationWith50BucketsERC721Pool is LiquidationERC721PoolInvariants {

    function setUp() public override {
        // failures reproduced with 50 active buckets
        vm.setEnv("NO_OF_BUCKETS", "50");
        super.setUp();
    }

    function test_regression_prototech_R6() external {
        _liquidationERC721PoolHandler.drawDebt(1, 113298570762, 9358434094103917567702497780937275074215496876507);
        _liquidationERC721PoolHandler.moveQuoteToken(656129, 18132963128529957026892178762731976037689118631117856017741085481808524663, 7513716401794, 0, 1);
        _liquidationERC721PoolHandler.mergeCollateral(76377166097425567976758425277113322220256222597234668275673107188469765075621, 199400660117592303848571100);
        _liquidationERC721PoolHandler.takeAuction(3, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _liquidationERC721PoolHandler.settleAuction(3165318593651680605490687697025152948487360712088438187639446, 0, 2, 1);
        _liquidationERC721PoolHandler.takeAuction(0, 1, 3630457090537537364638913640, 114699220986364344577145943479357079935130515386107950869255643);
        _liquidationERC721PoolHandler.mergeCollateral(3, 33464164);
        _liquidationERC721PoolHandler.addQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC721PoolHandler.moveQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 1, 10667116356, 0);
        _liquidationERC721PoolHandler.settleAuction(71729454820413303353814754475980941414529408945338085065505764108818744510179, 133173, 1869988, 18640181410506725405733865833824324648215384731482764797343269315726072954294);
        _liquidationERC721PoolHandler.moveQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 5, 0, 187983787476690621283465127784921013597494477839595679405);
        _liquidationERC721PoolHandler.addQuoteToken(1, 2, 1, 5446533932113181333454367135619458710798569643244365662819280542);
        _liquidationERC721PoolHandler.settleAuction(913378532475044656328538380900772381087030752042746816327, 2039130612458885, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _liquidationERC721PoolHandler.pledgeCollateral(550621228491694518340340422553, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 0);
        _liquidationERC721PoolHandler.addQuoteToken(110349606679412691172957834289542550319383271247755660854362242977991410051928, 37944553029460900151787544447113244339228489569884653359120018002410474311104, 424458744278137020977390453, 110349606679412691172957834289542550319383271247755660854362242977991410143230);
        _liquidationERC721PoolHandler.takeAuction(91972896697191588306399465032443194797295701854713098407, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 27565967710385, 1);
        _liquidationERC721PoolHandler.drawDebt(7331901639838245691919866416429738078558970, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC721PoolHandler.transferLps(492190042, 712507804741172518356579750, 522068057768522583099859765262845751875509941454475685170309, 45901269190, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _liquidationERC721PoolHandler.drawDebt(71994443714166075406633005251285562836772653, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 3544);
        _liquidationERC721PoolHandler.moveQuoteToken(0, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 2, 1, 197344369823278399005368383747840);
        _liquidationERC721PoolHandler.addQuoteToken(532247430521624073261207805, 86273356478354946804399741765118030147684070921859668529273368948299729572392, 110349606679412691172957834289542550319383271247755660854362242977991410138680, 110349606679412691172957834289542550319383271247755660854362242977991410102838);
        _liquidationERC721PoolHandler.addQuoteToken(6049, 113036808365357047396163273250845284856347394197766632691494752070902864583773, 43018148763831089448218950880013826400768827421799251802936760058797840694107, 130890324480926169753963777);
        _liquidationERC721PoolHandler.pullCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 2, 10582990004850936970963813733010571);
        _liquidationERC721PoolHandler.mergeCollateral(1, 281240456100454808194555036357);
        _liquidationERC721PoolHandler.takeAuction(992036, 101965989087839495236962803126658919611730096514066139349771586074267070843854, 28107967750866488455252011, 83896682086022740509951850293459585109634192332328313743431588437844528544732);
        _liquidationERC721PoolHandler.drawDebt(110319273221714951835697515241932202805628217994607248827288407996089120752772, 1131146669373593263718961231, 7212356);
        _liquidationERC721PoolHandler.settleAuction(17116901549949813353089855998957281878736737263289656, 73742378557, 101541249229254806352358225129603745030182, 2);
        _liquidationERC721PoolHandler.removeQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639932, 1, 1, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _liquidationERC721PoolHandler.settleAuction(1402125153251335683091752898041717002951799, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 6825481879221271194197392852249326010642441265402778787397554958369, 37307827397477247280480820776323146692462768188886952544782);
        _liquidationERC721PoolHandler.drawDebt(2442312710935101558807123, 98904174606107778693168979302054147103224661662497039149546778354822300418424, 5382296750125515490004472);

        invariant_bucket();
    }

    function test_regression_prototech_R21() external {
        _liquidationERC721PoolHandler.mergeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC721PoolHandler.pledgeCollateral(90400873124553291323020926, 73938082736036254729811858721, 6937930162775121660668934568);
        _liquidationERC721PoolHandler.removeCollateral(320593422951581925027593097972440841369905825, 1575217834911412556015681662504241007767331574024188284, 2101513633041000598395420868144601244627117606, 20371889848642984900182519127916200868613832784023609563);
        _liquidationERC721PoolHandler.repayDebt(75306328176325033159694955289, 22349244497874977061643733455, 39929341567191091257708866);
        _liquidationERC721PoolHandler.bucketTake(1, 2, false, 53044584234342815853301828453470622127019981522519200, 1);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.moveQuoteToken(128246266153501143633344520, 93758059992407620635467019, 67777313418904303359259568618, 29658655382944081403558397986, 8543816523171544119951205122);
        _liquidationERC721PoolHandler.kickAuction(489657196044929926683, 3948447184881097753, 60262878176901277819205622387013485363121386356495, 267710478);
        _liquidationERC721PoolHandler.kickWithDeposit(11226889112500570997195307101981, 2, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _liquidationERC721PoolHandler.bucketTake(2, 3, false, 8790302189051705945074750288678120985066663568137237257514679, 9816340843934526780743101598582030801660478312);
        _liquidationERC721PoolHandler.addQuoteToken(0, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 74206650373687412609660047975181420497169541487777800242, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _liquidationERC721PoolHandler.removeQuoteToken(47645065001943969072554143828, 683726927276697120570439020, 1000442049427258287, 779411284034291572477755223);
        _liquidationERC721PoolHandler.repayDebt(115792089237316195423570985008687907853269984665640564039457584007913129639935, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC721PoolHandler.bucketTake(21136611584245342596628554423, 16189064222729707783416802861, false, 44756835610653491039512423847, 964202460714149022143994);
        _liquidationERC721PoolHandler.addQuoteToken(120644660353423557646691434, 27370173886175976028090135, 2203230953557458956085478587, 137677927627896446470125660);
        _liquidationERC721PoolHandler.removeQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639932, 1, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 3);
        _liquidationERC721PoolHandler.mergeCollateral(20902325043402132093120794504, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _liquidationERC721PoolHandler.kickAuction(84935910972428875229941333, 746668989755411654110369939, 28089709797031063412529104348, 37078523082518777780450621515);
        _liquidationERC721PoolHandler.drawDebt(1130977827503227661915590721, 11722945224724752761760240352, 937142191275283461392120335);
        _liquidationERC721PoolHandler.repayDebt(1038334822344473974551, 27646921911006791861645478232424091180732151346537917398453855244037233, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _liquidationERC721PoolHandler.addQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639933, 106453792753972194670158337562764805528077982021590985, 859896809803867239808035200034254, 0);
        _liquidationERC721PoolHandler.mergeCollateral(30373754077716620570741289048, 1445778374862579596549351787);
        _liquidationERC721PoolHandler.addQuoteToken(38, 1, 1259331949246403909477929589255303542332, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _liquidationERC721PoolHandler.withdrawBonds(114896568431071365365007038500354580491904811276240732147240, 1066236161342180110858202170884772219995758887222, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _liquidationERC721PoolHandler.kickWithDeposit(2, 1251616983885, 3);
        _liquidationERC721PoolHandler.kickAuction(1000017614000454057, 1937262146, 60205240058955910120537684219, 84080102287851047012691023);
        _liquidationERC721PoolHandler.takeAuction(33921446663787971053978514474, 56914249130254139414805535561, 12281911687111399888608416797, 10168254781572051802912438656);
        _liquidationERC721PoolHandler.drawDebt(0, 2, 1);
        _liquidationERC721PoolHandler.settleAuction(115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 2672932083692033734370933732230159303825951338487771023220, 100217809911605817213525596717422602281652323593798353203929683291274305);
        _liquidationERC721PoolHandler.mergeCollateral(10013325599632731815303223260, 3329681195257923153738019513);
        _liquidationERC721PoolHandler.repayDebt(73533225186518821630404247916830727076247, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 16635180628026691987132817722981163);
        _liquidationERC721PoolHandler.addCollateral(3576, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 201929814404022152910872918819102468177962840260645204368138836, 1235746);
        _liquidationERC721PoolHandler.transferLps(9093431009805938129842010596, 1062652420801875746, 84168370523713933794384430, 55824151828527836181309584, 95842402273557094939875301);
        _liquidationERC721PoolHandler.removeCollateral(40732134965742487663955939, 33745391685868308133254186782, 79622252966744808258131908699, 40000729279426907616179739);
        _liquidationERC721PoolHandler.mergeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 143098819);
        _liquidationERC721PoolHandler.withdrawBonds(0, 5188002650072081399, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _liquidationERC721PoolHandler.transferLps(94874285728634961532873306, 44081195411837036778784073562, 51037953686574442246486745, 69538773903531573150179060, 61758721393218593965285091);
        _liquidationERC721PoolHandler.takeAuction(115792089237316195423570985008687907853269984665640564039457584007913129639932, 0, 3975791487581581649013465193485068070450741671863461235513686136, 5041248695659468273297349375570309281505936390268175301560701584445);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.transferLps(197989722098016907913571591032085388844675119985, 2609296479223016987357628145162707593656924503999780477500634, 8277580864272576865556578198802539684411348963128500765410927768930713, 941700759581010099106806533028284707648669958878, 1937637905322586582674540478627623039814);
        _liquidationERC721PoolHandler.kickAuction(3382581645841287073674424043, 125602201130681070447409228, 379298508786108459999198744, 394086914712414005878583506);
        _liquidationERC721PoolHandler.kickAuction(1269649157719379653666805584365421433, 1, 273686148185, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _liquidationERC721PoolHandler.settleAuction(115792089237316195423570985008687907853269984665640564039457584007913129639933, 106376116463152213500300632415069693983726, 20474334847645738668, 58624985042854727231837782853806646357);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.drawDebt(32495870886720956546840756510, 8381009109534850893805357243646418382662352148153864973213067407774910503, 66071009250135829685561938472);
        _liquidationERC721PoolHandler.drawDebt(42200940282408957755144535, 33123406008405689547378908236, 194149612314119801858003730586960462);
        _liquidationERC721PoolHandler.settleAuction(49125550634259898607614967396625582270705499961605827919329837, 15554763244090253690241367591407384, 24728, 83620380);
        _liquidationERC721PoolHandler.bucketTake(88748641677666065614636834040, 72617935492158075283681332, false, 3512354413200679227935706922, 66937109387014775000725421);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.mergeCollateral(2974877736982636183201629625345828342, 21904828629144090634172416256139949490740275126);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.removeQuoteToken(1, 28844184118270906409888222607082190334973464466133773356952352008, 27339476150877755582677342559826598192184821445677662175380, 875304713608990046523237064880127737267438543660655990);
        _liquidationERC721PoolHandler.withdrawBonds(115792089237316195423570985008687907853269984665640564039457584007913129639935, 99985553, 474561957813414367839370808059810659756069656257);
        _liquidationERC721PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639934, 2, 784336695015546450202718291137765245465383668994910577779534978, 281048295735130708883101778612281);
        _liquidationERC721PoolHandler.pullCollateral(50800363497111174889702110747, 55877900026337777138430510888, 1000774322457479879177282359);
        _liquidationERC721PoolHandler.kickWithDeposit(19442807502373494177116309015, 165329597463217757525565771, 12746167329442130275114158562);
        _liquidationERC721PoolHandler.settleAuction(0, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _liquidationERC721PoolHandler.pledgeCollateral(1, 555782489664659434222119552746093342159279001577011, 1);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.bucketTake(1, 147573324773552269974313795084359874653121513619954, true, 2390551012346769214633523304611615536231462052402080, 1);
        _liquidationERC721PoolHandler.bucketTake(943, 115792089237316195423570985008687907853269984665640564039457584007913129639935, true, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 3);
        _liquidationERC721PoolHandler.takeAuction(55389094784067933625466515708, 30219713232096552409222868265, 1080443610002539896, 1001273206944401893);
        _liquidationERC721PoolHandler.takeAuction(81696247836659195976617371885, 913827910374243077875838404, 27156039790003923963707500, 1170408794700280262);
        _liquidationERC721PoolHandler.takeAuction(1, 6849515, 133310267172967627896, 84741026555516630951766766273081019747180684194617372766290956099058159315851);
        _liquidationERC721PoolHandler.removeCollateral(62594478208860358419427240, 63700193109626221752416452035, 39945877902435742769822964884, 231774931108337257699488652660063352);
        _liquidationERC721PoolHandler.kickAuction(24578581168306620641574764, 16413553433201587842400735527, 24212318129753203869076557, 10496705010527111998430369061);
        _liquidationERC721PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 6, 3, 2321134968288356978644);
        _liquidationERC721PoolHandler.removeCollateral(51050115158473514120205350321, 18154225200841711463780206151, 27008287320489623957358382, 12263316352359432662286960);
        _liquidationERC721PoolHandler.withdrawBonds(115792089237316195423570985008687907853269984665640564039457584007913129639933, 8181731437046553338145712327835444971639279069008535533, 1);
        _liquidationERC721PoolHandler.withdrawBonds(0, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 209037076607);
        _liquidationERC721PoolHandler.repayDebt(1, 8336779831797460197801763755, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _liquidationERC721PoolHandler.mergeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _liquidationERC721PoolHandler.bucketTake(29993958476456147563204181537887618346424, 115792089237316195423570985008687907853269984665640564039457584007913129639934, true, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 68319597014);
        _liquidationERC721PoolHandler.settleAuction(62327682220484206871903967718340409567719302497922097525845296561024214439787, 29831460962918572074404508, 47835944487755156532343618893, 94756528983736207892908221);
        _liquidationERC721PoolHandler.withdrawBonds(4563562065074482877287077714, 17034194747403881324589960176, 14346419548221813421930315);
        _liquidationERC721PoolHandler.addQuoteToken(0, 6667967485379259978752256195912033031929667142998934, 1, 1);
        _liquidationERC721PoolHandler.withdrawBonds(0, 11138318352443324427252583284709459712927770707460734430741792991175323372, 2);
        _liquidationERC721PoolHandler.withdrawBonds(2, 2, 4424114694699049641662529226237747088165860190880);
        _liquidationERC721PoolHandler.pledgeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639934, 16692526284454192591691974850454, 483319114560546645085687461723730438954364999836155559);
        _liquidationERC721PoolHandler.pledgeCollateral(2, 3, 55905233200789938762124137496271818558309778664345279855362404902484752797249);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.settleAuction(255497690930097949622844598536231018628151186992370629257506016920, 11972612, 19088870005598539714669866509540215472774398568, 163996011908770110046222706034849962235040);
        _liquidationERC721PoolHandler.addCollateral(96256687817895597363028745, 0, 2636415126631934087862993094613395830881096772384138419809, 115792089237316195423570985008687907853269984665640564039457584007913129639935);
        _liquidationERC721PoolHandler.kickAuction(30002200559223526859629907918, 14041334327788764538906140469, 72192312073785818053781453, 30073068216630817330434583224);
        _liquidationERC721PoolHandler.addCollateral(3, 0, 6782655846430789107546743633128014997, 0);
        _liquidationERC721PoolHandler.moveQuoteToken(373445906544682271636454806605191111837962222043310239480597570185, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 1025988070932091730162139821505178187358803145251235477535853, 10921899636198192723100254969763669748639764126967415124, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _liquidationERC721PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639932, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 74937290812866002780551440469106369068266287859, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC721PoolHandler.removeQuoteToken(151026235053230636389650467, 48984998452221732876083348976, 3809815224052650143162465195, 83522190998774765536896241059);
        _liquidationERC721PoolHandler.removeQuoteToken(18609879237516873948727086501, 13167945615757307654285655, 80264402207410484115349985, 1138392610820657701293937282);
        _liquidationERC721PoolHandler.bucketTake(115792089237316195423570985008687907853269984665640564039457584007913129639933, 202062576495255206879128480963065927611917940067640801000327892418496, false, 423683153806735192173841264090549, 178157838925730154502902580638125);
        _liquidationERC721PoolHandler.withdrawBonds(31930008472874851423987707806, 12642973406133619041728226499, 47660723618776870016651077085);
        _liquidationERC721PoolHandler.addQuoteToken(174001052341119682618554846, 1001695666717240986, 110349606679412691172957834289542550319383271247755660854362242977991410039560, 1461712665450929413910420902);
        _liquidationERC721PoolHandler.repayDebt(115792089237316195423570985008687907853269984665640564039457584007913129639932, 1, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _liquidationERC721PoolHandler.addCollateral(66402824466429767295770371902, 24452952247474661676288454, 3195032617875730464749024992, 24584401104458315657258247211);
        _liquidationERC721PoolHandler.removeCollateral(37017455018001992262141077, 126992355982290392402122399, 11889359573581690189919670874, 25222143502165501961922232);
        _liquidationERC721PoolHandler.transferLps(115792089237316195423570985008687907853269984665640564039457584007913129639933, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 1);
        _liquidationERC721PoolHandler.kickWithDeposit(5338565252097, 3, 47309947930543245493153708118);
        _liquidationERC721PoolHandler.removeQuoteToken(10963616189207235963101963141, 56531170927614229414639811931, 56202350775382975179469984280, 55782393002912977616653142757);
        _liquidationERC721PoolHandler.transferLps(39035084385064971318491139516576135904258, 2593427896454915447938071847449754195364738222225308482, 13829655831912810165333923965106, 861153, 977779214503096951148970787507);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.moveQuoteToken(18974221507538496457212947371, 2411377258663345215, 141194101183899976494790199, 63626806716586960689931478, 38167341996857537894796145387);
        _liquidationERC721PoolHandler.bucketTake(1006689251445726227, 132543552238559607252883017, false, 38576524506606375151079693551, 1108491682205706898);
        _liquidationERC721PoolHandler.addCollateral(17004621891662273303804155576, 2234966368549321427894121, 7245585728079476693689430053, 39347653272225587096122103886);
        _liquidationERC721PoolHandler.bucketTake(42997767084072942458083727641, 4060860047825345690749709120, false, 25826945258340954636469364510, 24606328176488379494803064);
        _liquidationERC721PoolHandler.kickAuction(258321464, 29713, 77351597137226575318927603946826801, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _liquidationERC721PoolHandler.kickAuction(79448825212585285248579989865713991313082040652002548, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 3);
        _liquidationERC721PoolHandler.removeCollateral(767952418031430801472384327157395205535868773821475985473669841695938105, 1014467957004878572, 47187068718394885616783951134, 82270749068613563409070175303);
        _liquidationERC721PoolHandler.drawDebt(53820084170915512105477833, 193327684294378075943107521, 14138804028798087092847814);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639933, 1, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 246756631005953923);
        _liquidationERC721PoolHandler.addQuoteToken(1614051533930599198994728, 25031007947976369, 6507870532733941369882695038744902853503179141864975374, 0);
        _liquidationERC721PoolHandler.removeQuoteToken(167660182761964416174960147, 72068527978125492293069489, 1002877998580057757, 266796389326520235443467560496393594);
        _liquidationERC721PoolHandler.bucketTake(9509935940959253556230842907, 133038587744824693815659637, false, 66536411287185095699610579, 46353345220413714316592472);
        _liquidationERC721PoolHandler.removeQuoteToken(49021015487594408040769920670, 427064390179272227580457858, 9195147828634884483386709, 56047641770205762681674145982);
        _liquidationERC721PoolHandler.kickAuction(115792089237316195423570985008687907853269984665640564039457584007913129639935, 905945823956051888246403863490487542809012523638, 106060470320567841608215145828008397435171940859802442211401966653028245570, 3455992203429);
        _liquidationERC721PoolHandler.removeQuoteToken(17802, 106991687482680230335729127342548804195572683758806647276962763075155, 285830604793183026965653819543082404267, 1986244048324640944964797823576294512904224972);
        _liquidationERC721PoolHandler.withdrawBonds(7247780305082102766080712718222519815890323930983254449029056051687683695, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 0);
        _liquidationERC721PoolHandler.kickAuction(115792089237316195423570985008687907853269984665640564039457584007913129639935, 28359316634291303441959490639213337481517341, 1171621326046027505703207310765801747229086, 1);
        _liquidationERC721PoolHandler.mergeCollateral(124017182856200604490152324391282765, 111231560207984065532324589);
        _liquidationERC721PoolHandler.withdrawBonds(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.bucketTake(1, 3, false, 3, 2311845498592644505683226691717196769620101566771296052103748330459607649833);
        _liquidationERC721PoolHandler.bucketTake(153350748, 115792089237316195423570985008687907853269984665640564039457584007913129639934, false, 555631187846617075427080626613262570707, 3);
        _liquidationERC721PoolHandler.moveQuoteToken(0, 1685854674386168817413877603534070482215259813, 554912320692458257222051872702353, 63, 252128881787933427993883689729084028087829636591156315621543361);
        _liquidationERC721PoolHandler.kickAuction(38440711228894421914280000597571950461691845543618724193004414326713817022, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 3);
        _liquidationERC721PoolHandler.repayDebt(3074660953400451416243411697, 100882720198858743641192158571, 84991858092939249731155059);
        _liquidationERC721PoolHandler.moveQuoteToken(0, 21749813389130039, 3, 3, 92544936612547455863793442051);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.repayDebt(115792089237316195423570985008687907853269984665640564039457584007913129639935, 14318649261667593511789674148870501417525060948345042232717690, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _liquidationERC721PoolHandler.settleAuction(981184677373564902111469884, 1000001380011099347, 12036186037054958057388536974, 11313859444302617622697932776);
        _liquidationERC721PoolHandler.takeAuction(70597070029841839441224559, 146013318779933283624101686, 1027393458082829715, 78359356562568421457292431);
        _liquidationERC721PoolHandler.bucketTake(115792089237316195423570985008687907853269984665640564039457584007913129639933, 1027519977703582726, true, 66626192312613611476412161116942, 496932);
        _liquidationERC721PoolHandler.kickAuction(34511822154046172926796922731599954910813659399754802, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 74463224310644374097219922741779324840, 0);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.repayDebt(25706724922471039016801817, 1010932242718864125, 52745220485855053945019213132);
        _liquidationERC721PoolHandler.removeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639932, 14068535555232331, 0, 268668439271632917622330945627424382284880509233810302327986);
        _liquidationERC721PoolHandler.drawDebt(8376539446469594091875627857, 14413019087566548217674665, 99222827859950258009668639959);
        _liquidationERC721PoolHandler.transferLps(5009915076906959496484301000, 50287308009528253636819481775, 29944910353671941923545463056, 95002319174013386, 1009200235805066676);
        _liquidationERC721PoolHandler.kickWithDeposit(19148030739089893746605364011, 40323223391224759139967056, 119241852192623105818839916);
        _liquidationERC721PoolHandler.repayDebt(2, 115792089237316195423570985008687907853269984665640564039457584007913129639932, 15376);
        _liquidationERC721PoolHandler.moveQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639934, 311613296384038614030447551684034319530500686975560801894054860, 0, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 76104321272370718217068099328588065);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.removeCollateral(13782916403458249022555642, 760484155318764996217248905811235857254874077317065436921858076730806293, 16740586453273621271807771419, 18815633009844972134073999417);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.addCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639934, 2, 51559198405696529348167, 1117253237703125321397941357050731444228297418);
        _liquidationERC721PoolHandler.settleAuction(1, 2, 1, 1);
        _liquidationERC721PoolHandler.moveQuoteToken(22362761505676265880802451781, 67885998371693191440588240, 4070038292225652182497871329, 57202847529920521775329081, 3626508771070625024689382596);
        _liquidationERC721PoolHandler.moveQuoteToken(274959280912400729464399829817790187312439052165361474056053775083734237, 2, 25330964523442159249727794631063983564258437386573231875630011330628843371, 2, 1);
        _liquidationERC721PoolHandler.removeCollateral(41859932446717201132698671, 395577065500575001741115324600790048, 70785116556754732011167668145, 216004);
        _liquidationERC721PoolHandler.removeCollateral(498297720903799737841136, 82099297173371313503591416314070224728, 115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC721PoolHandler.kickWithDeposit(2, 3, 2271787097342);
        _liquidationERC721PoolHandler.transferLps(5278873, 190740751046898825150001684662350904461030925557134670672987666965, 124160184043309955719380, 8949238380238325204417172974855145761397, 1);
        _liquidationERC721PoolHandler.removeQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639932, 10404112797809161726101930173226960468106573700940419, 3157320684589670250776992056047299000703362021199092367240114813670, 115792089237316195423570985008687907853269984665640564039457584007913129639933);
        _liquidationERC721PoolHandler.mergeCollateral(161957876509973882369542025, 7601509388714575228343836225);
        _liquidationERC721PoolHandler.mergeCollateral(156469930553872231112691054, 3230638802384445560280512941);
        _liquidationERC721PoolHandler.repayDebt(12063882644884196877140783184, 77144551902426858703857559, 49860686120756497688071055007);
        _liquidationERC721PoolHandler.failed();
        _liquidationERC721PoolHandler.moveQuoteToken(3079012347313753459677611250907018650430638, 672905857165647733410034978012053639774215945, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 8662412020188, 760367616609107);
        _liquidationERC721PoolHandler.repayDebt(1002802023546251788, 13046744936103904772789613, 51321115087194121714852923389);
        _liquidationERC721PoolHandler.repayDebt(25703836399826804902064887, 18350730276135885100591978628, 87038317394867015693349740);
        _liquidationERC721PoolHandler.moveQuoteToken(18118593713459877991657039065, 28472298106499590193369835, 50218485131805505408016934164, 1477004442601893926708046873, 78026484404140404752993706);
        _liquidationERC721PoolHandler.withdrawBonds(115792089237316195423570985008687907853269984665640564039457584007913129639933, 115792089237316195423570985008687907853269984665640564039457584007913129639934, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _liquidationERC721PoolHandler.drawDebt(3, 3, 28833236028495312510473603129591278);

        invariant_collateral(); 
    }
}

/***************************************/
/*** Reserves ERC721 Pool Regression ***/
/***************************************/

contract PrototechRegressionTestReserveWith50BucketsIndex500ERC721Pool is ReserveERC721PoolInvariants {

    function setUp() public override {
        // failures reproduced with 50 active buckets
        vm.setEnv("NO_OF_BUCKETS", "50");
        vm.setEnv("BUCKET_INDEX_ERC721", "500");
        super.setUp();
    }

    function test_regression_prototech_R20() external {
        _reserveERC721PoolHandler.addQuoteToken(2999788268657326407944926908, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 1429607349403855207572422861345572911930045098824596, 250401224418406565);
        _reserveERC721PoolHandler.mergeCollateral(115792089237316195423570985008687907853269984665640564039457584007913129639932, 151102099619537411718964480257953591711200462549753742893625548598);
        _reserveERC721PoolHandler.removeCollateral(196004599218061365856911433, 2540607559186040068831916, 3856898017735098413817902881446, 512942718975051112747257985);
        _reserveERC721PoolHandler.kickReserveAuction(2, 560899610178108403580638879353454631945616273759677220014);
        _reserveERC721PoolHandler.kickAuction(79365337110697200815750600, 2028294568132335464815472040106, 1264290062667217078515279422882, 798362274929997626653452547879);
        _reserveERC721PoolHandler.removeQuoteToken(6205805560222413946498346768257, 773582559752808029739030260, 365012003960337371149429921, 4432092541739186353301337880417);
        _reserveERC721PoolHandler.kickAuction(1, 115792089237316195423570985008687907853269984665640564039457584007913129639935, 11741925789341657822450468722056873138201869127897921476858160142803634421678, 3911830047849218475059505439923287204326983882884238572513962255274);
        _reserveERC721PoolHandler.kickAuction(89627001924390549423496301030747944, 8089741688196955747325971804452073092121520258522023096372, 17377850836224646066130027647698332299, 0);
        _reserveERC721PoolHandler.kickAuction(659653836301081167743470281, 1319029405990247001137308081042, 1002741854643006198644931983944, 827731256738933274188726485822);
        _reserveERC721PoolHandler.withdrawBonds(529493476517561479443093795, 416437223268421414798008763, 5637358759416003594293930970302);
        _reserveERC721PoolHandler.withdrawBonds(1151455606749067812816950277184289516346415122185117642620200402549726, 746934060354119231820598751535104298904661, 115792089237316195423570985008687907853269984665640564039457584007913129639934);
        _reserveERC721PoolHandler.bucketTake(15889152020360154, 2615840526241552306204295823025956351926767147973553781262158576562859, true, 482352186892285130678300087172925524517, 68631118756842552943558390503126989);
        _reserveERC721PoolHandler.takeReserves(483128102187744950097349766, 884849871024522135359473940413, 6682943969708452204195732316061);
        _reserveERC721PoolHandler.kickAuction(1788564725001319952517177962891, 390859279650139384172841657964633394, 1516928447231025870672821705587472583, 1208000350844258482102802524368692273);
        _reserveERC721PoolHandler.repayDebt(1263557119416361100813166285604, 118999997260273972603, 999999999999999998874712295548494449223488912);
        _reserveERC721PoolHandler.takeReserves(1824947145715499641454211768399, 1000175162188999453, 4097100813341233524452769284569);
        _reserveERC721PoolHandler.repayDebt(365972639095681511013173376002597259827738706874047756567599604826996143120, 78175224211606374605620654846918600066237, 133544958106);
        _reserveERC721PoolHandler.transferLps(2, 459169204120817627198031162, 3, 9625381135855426730849548641829484, 23857150371106151299422730510649449117212945966466874257921806374);
        _reserveERC721PoolHandler.removeQuoteToken(2, 67564687075252382, 2, 23891243607278245379013301425230931629733113096271491368019410095116331);
        _reserveERC721PoolHandler.moveQuoteToken(115792089237316195423570985008687907853269984665640564039457584007913129639935, 35450674322705284821942516839154382204568672893252387, 121731269707612708929414475829855764040898036164285263639318093298, 3, 115792089237316195423570985008687907853269984665640564039457584007913129639932);
        _reserveERC721PoolHandler.drawDebt(9763173688032744223791495836322659847699115078857452214942679391421214, 334515533652710404942344150, 1);

        invariant_collateral();
    }
}
